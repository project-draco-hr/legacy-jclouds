{
  return new Predicate<Task>(){
    @Override public boolean apply(    Task task){
      TaskClient taskClient=context.getApi().getTaskClient();
      task=taskClient.getTask(task.getHref());
switch (task.getStatus()) {
case QUEUED:
case RUNNING:
        return false;
case COMPLETE:
case SUCCESS:
      return true;
default :
    throw new RuntimeException("Task Failed:" + task.getHref() + ", Status:"+ task.getStatus());
}
}
}
;
}
