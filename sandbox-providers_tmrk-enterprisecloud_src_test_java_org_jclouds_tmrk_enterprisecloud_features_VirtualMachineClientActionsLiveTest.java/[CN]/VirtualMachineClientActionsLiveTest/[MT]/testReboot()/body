{
  RetryablePredicate retryablePredicate=new RetryablePredicate(taskFinished(),1000 * 60);
  if (!retryablePredicate.apply(client.powerOn(vm.getHref()))) {
    fail("Did not manage to finish powerOn task");
  }
  if (!mountTools(vm.getHref())) {
    fail("Did not manage to mount tools");
  }
  retryablePredicate=new RetryablePredicate(taskFinished(),1000 * 60);
  if (!retryablePredicate.apply(client.reboot(vm.getHref()))) {
    fail("Did not manage to finish reboot task");
  }
  vm=client.getVirtualMachine(vm.getHref());
  assertTrue(vm.isPoweredOn());
}
