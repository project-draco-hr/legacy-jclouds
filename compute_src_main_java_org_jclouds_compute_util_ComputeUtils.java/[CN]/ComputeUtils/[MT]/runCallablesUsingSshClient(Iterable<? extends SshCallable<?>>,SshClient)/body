{
  Map<SshCallable<?>,ListenableFuture<?>> parallelResponses=Maps.newHashMap();
  for (  SshCallable<?> callable : parallel) {
    callable.setConnection(ssh,logger);
    parallelResponses.put(callable,ConcurrentUtils.makeListenable(executor.submit(callable),executor));
  }
  Map<SshCallable<?>,Exception> exceptions=awaitCompletion(parallelResponses,executor,null,logger,"ssh");
  if (exceptions.size() > 0)   throw new RuntimeException(String.format("error invoking callables on nodes: %s",exceptions));
  Map<SshCallable<?>,Object> newresponses=transform(parallelResponses);
  return newresponses;
}
