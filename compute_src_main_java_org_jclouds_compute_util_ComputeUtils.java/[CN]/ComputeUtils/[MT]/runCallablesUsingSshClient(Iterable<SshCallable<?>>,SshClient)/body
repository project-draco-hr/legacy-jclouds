{
  Map<SshCallable<?>,Future<?>> parallelResponses=newHashMap();
  for (  SshCallable<?> callable : parallel) {
    callable.setConnection(ssh,logger);
    parallelResponses.put(callable,executor.submit(callable));
  }
  Map<SshCallable<?>,Exception> exceptions=awaitCompletion(parallelResponses,executor,null,logger,"ssh");
  if (exceptions.size() > 0)   throw new RuntimeException(String.format("error invoking callables on nodes: %s",exceptions));
  Map<SshCallable<?>,Object> newresponses=transform(parallelResponses);
  return newresponses;
}
