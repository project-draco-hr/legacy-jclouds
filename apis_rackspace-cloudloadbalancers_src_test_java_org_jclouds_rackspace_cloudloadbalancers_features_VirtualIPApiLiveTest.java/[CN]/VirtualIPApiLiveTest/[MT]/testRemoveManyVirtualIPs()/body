{
  Iterable<VirtualIPWithId> actualVirtualIPs=clbApi.getVirtualIPApiForZoneAndLoadBalancer(zone,lb.getId()).list();
  VirtualIPWithId removedVirtualIP1=Iterables.getFirst(actualVirtualIPs,null);
  VirtualIPWithId removedVirtualIP2=Iterables.getLast(actualVirtualIPs);
  List<Integer> removedVirtualIPIds=ImmutableList.<Integer>of(removedVirtualIP1.getId(),removedVirtualIP2.getId());
  assertTrue(clbApi.getVirtualIPApiForZoneAndLoadBalancer(zone,lb.getId()).remove(removedVirtualIPIds));
  assertTrue(awaitAvailable(clbApi.getLoadBalancerApiForZone(zone)).apply(lb));
  actualVirtualIPs=clbApi.getVirtualIPApiForZoneAndLoadBalancer(zone,lb.getId()).list();
  assertEquals(Iterators.size(actualVirtualIPs.iterator()),2);
}
