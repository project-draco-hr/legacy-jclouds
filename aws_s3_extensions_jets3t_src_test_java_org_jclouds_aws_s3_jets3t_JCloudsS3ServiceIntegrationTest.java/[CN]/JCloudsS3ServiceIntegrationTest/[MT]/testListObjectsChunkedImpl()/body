{
  addObjectToBucket(commonTestingBucketName,"item1/subobject2");
  addObjectToBucket(commonTestingBucketName,"item2");
  addObjectToBucket(commonTestingBucketName,"object1");
  addObjectToBucket(commonTestingBucketName,"object2/subobject1");
  S3ObjectsChunk chunk;
  chunk=service.listObjectsChunked(commonTestingBucketName,null,null,1000,null,true);
  assertEquals(chunk.getObjects().length,4);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertNull(chunk.getPrefix());
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,null,null,2,null,false);
  assertEquals(chunk.getObjects().length,2);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertNull(chunk.getPrefix());
  assertEquals(chunk.getPriorLastKey(),"item2");
  chunk=service.listObjectsChunked(commonTestingBucketName,null,null,2,null,true);
  assertEquals(chunk.getObjects().length,4);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertNull(chunk.getPrefix());
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,null,null,1000,"item1/subobject2",true);
  assertEquals(chunk.getObjects().length,3);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertNull(chunk.getPrefix());
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,null,null,1000,"object1",true);
  assertEquals(chunk.getObjects().length,1);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertNull(chunk.getPrefix());
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,"item",null,1000,null,true);
  assertEquals(chunk.getObjects().length,2);
  assertEquals(chunk.getCommonPrefixes().length,0);
  assertNull(chunk.getDelimiter());
  assertEquals(chunk.getPrefix(),"item");
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,null,"/",1000,null,true);
  assertEquals(chunk.getObjects().length,2);
  assertEquals(chunk.getCommonPrefixes().length,2);
  assertEquals(chunk.getDelimiter(),"/");
  assertNull(chunk.getPrefix());
  assertNull(chunk.getPriorLastKey());
  chunk=service.listObjectsChunked(commonTestingBucketName,"item","/",1000,null,true);
  assertEquals(chunk.getObjects().length,1);
  assertEquals(chunk.getCommonPrefixes().length,1);
  assertEquals(chunk.getDelimiter(),"/");
  assertEquals(chunk.getPrefix(),"item");
  assertNull(chunk.getPriorLastKey());
  emptyBucket(commonTestingBucketName);
}
