{
  InputStream is=getClass().getResourceAsStream("/terremark/get_vapp.xml");
  VApp result=(VApp)factory.create(injector.getInstance(TerremarkVAppHandler.class)).parse(is);
  assertEquals(result.getId(),13850 + "");
  assertEquals(result.getName(),"adriantest1");
  assertEquals(result.getStatus(),VAppStatus.OFF);
  assertEquals(result.getSize(),4194304);
  assertEquals(result.getOperatingSystemDescription(),"Ubuntu Linux (32-bit)");
  assertEquals(result.getLocation(),URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vapp/13850"));
  assertEquals(result.getType(),"application/vnd.vmware.vcloud.vApp+xml");
  assertEquals(result.getVDC(),new LinkImpl(VCloudMediaType.VDC_XML,URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vdc/32")));
  assertEquals(result.getComputeOptions(),new LinkImpl(MediaType.APPLICATION_XML,URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vapp/13850/options/compute")));
  assertEquals(result.getCustomizationOptions(),new LinkImpl(MediaType.APPLICATION_XML,URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vapp/13850/options/customization")));
  assertEquals(result.getSystem(),new VirtualSystem(null,null,null,null,null,null,null,null,null,null,null,"Virtual Hardware Family",0,null,null,null,null,null,"adriantest1","vmx-07"));
  assertEquals(result.getNetworkToAddresses().get("Internal"),ImmutableList.of(InetAddress.getByName("10.114.34.132")));
  ResourceAllocation cpu=new ResourceAllocation(null,null,"hertz * 10^6",null,null,null,null,"Number of Virtual CPUs","1 virtual CPU(s)",null,1,null,null,null,null,null,null,null,ResourceType.VIRTUAL_CPU,1,"count",null);
  ResourceAllocation controller=new ResourceAllocation(0,null,null,null,null,null,null,"SCSI Controller","SCSI Controller 0",null,3,null,null,null,null,null,null,"lsilogic",ResourceType.SCSI_CONTROLLER,1,null,null);
  ResourceAllocation memory=new ResourceAllocation(null,null,"byte * 2^20",null,null,null,null,"Memory Size","512MB of memory",null,2,null,null,null,null,null,null,null,ResourceType.MEMORY,512,"byte * 2^20",null);
  ResourceAllocation disk=new ResourceAllocation(null,0,null,null,null,null,null,null,"Hard Disk 1","4194304",9,null,null,null,3,null,null,null,ResourceType.VIRTUAL_DISK,4194304,null,null);
  assertEquals(result.getResourceAllocations(),ImmutableSortedSet.of(cpu,controller,memory,disk));
  assertEquals(result.getResourceAllocationByType().get(ResourceType.VIRTUAL_CPU).getVirtualQuantity(),1);
  assertEquals(result.getResourceAllocationByType().get(ResourceType.SCSI_CONTROLLER).getVirtualQuantity(),1);
  assertEquals(result.getResourceAllocationByType().get(ResourceType.MEMORY).getVirtualQuantity(),512);
  assertEquals(result.getResourceAllocationByType().get(ResourceType.VIRTUAL_DISK).getVirtualQuantity(),4194304);
  assertEquals(result.getSize(),result.getResourceAllocationByType().get(ResourceType.VIRTUAL_DISK).getVirtualQuantity());
}
