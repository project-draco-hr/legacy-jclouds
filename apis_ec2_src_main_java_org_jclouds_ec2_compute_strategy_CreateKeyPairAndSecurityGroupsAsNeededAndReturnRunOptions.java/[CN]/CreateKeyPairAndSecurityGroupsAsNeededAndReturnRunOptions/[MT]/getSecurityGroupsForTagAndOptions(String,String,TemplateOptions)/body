{
  Builder<String> groups=ImmutableSet.builder();
  if (group != null) {
    String markerGroup=namingConvention.create().sharedNameForGroup(group);
    groups.add(markerGroup);
    RegionNameAndIngressRules regionNameAndIngessRulesForMarkerGroup;
    if (userSpecifiedTheirOwnGroups(options)) {
      regionNameAndIngessRulesForMarkerGroup=new RegionNameAndIngressRules(region,markerGroup,new int[]{},false);
      groups.addAll(EC2TemplateOptions.class.cast(options).getGroups());
    }
 else {
      regionNameAndIngessRulesForMarkerGroup=new RegionNameAndIngressRules(region,markerGroup,options.getInboundPorts(),true);
    }
    securityGroupMap.getUnchecked(regionNameAndIngessRulesForMarkerGroup);
  }
  return groups.build();
}
