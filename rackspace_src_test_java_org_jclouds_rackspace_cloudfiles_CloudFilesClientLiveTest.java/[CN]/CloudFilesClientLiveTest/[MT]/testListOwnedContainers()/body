{
  String containerPrefix=getContainerName();
  try {
    SortedSet<ContainerMetadata> response=context.getApi().listContainers().get(10,TimeUnit.SECONDS);
    assertNotNull(response);
    long initialContainerCount=response.size();
    assertTrue(initialContainerCount >= 0);
    String[] containerJsr330=new String[]{containerPrefix + ".testListOwnedContainers1",containerPrefix + ".testListOwnedContainers2"};
    assertTrue(context.getApi().createContainer(containerJsr330[0]).get(10,TimeUnit.SECONDS));
    assertTrue(context.getApi().createContainer(containerJsr330[1]).get(10,TimeUnit.SECONDS));
    response=context.getApi().listContainers().get(10,TimeUnit.SECONDS);
    response=context.getApi().listContainers(ListContainerOptions.Builder.afterMarker(containerJsr330[0].substring(0,containerJsr330[0].length() - 1)).maxResults(1)).get(10,TimeUnit.SECONDS);
    assertEquals(response.size(),1);
    assertEquals(response.first().getName(),containerJsr330[0]);
    response=context.getApi().listContainers(ListContainerOptions.Builder.afterMarker(containerJsr330[0]).maxResults(1)).get(10,TimeUnit.SECONDS);
    assertEquals(response.size(),1);
    assertEquals(response.first().getName(),containerJsr330[1]);
    assertTrue(context.getApi().deleteContainerIfEmpty(containerJsr330[0]).get(10,TimeUnit.SECONDS));
    assertTrue(context.getApi().deleteContainerIfEmpty(containerJsr330[1]).get(10,TimeUnit.SECONDS));
    response=context.getApi().listContainers().get(10,TimeUnit.SECONDS);
  }
  finally {
    returnContainer(containerPrefix);
  }
}
