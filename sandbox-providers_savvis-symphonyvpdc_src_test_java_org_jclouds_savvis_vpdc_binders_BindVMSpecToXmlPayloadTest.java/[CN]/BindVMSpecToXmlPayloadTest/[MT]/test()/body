{
  CIMOperatingSystem os=Iterables.find(new Gson().<Set<CIMOperatingSystem>>fromJson(Strings2.toStringAndClose(getClass().getResourceAsStream("/savvis-symphonyvpdc/predefined_operatingsystems.json")),new TypeLiteral<Set<CIMOperatingSystem>>(){
  }
.getType()),new Predicate<CIMOperatingSystem>(){
    @Override public boolean apply(    CIMOperatingSystem arg0){
      return arg0.getOsType() == OSType.RHEL_64;
    }
  }
);
  String expected=Strings2.toStringAndClose(getClass().getResourceAsStream("/vm-default.xml"));
  VMSpec spec=VMSpec.builder().operatingSystem(os).build();
  assertEquals(new BindVMSpecToXmlPayload().generateXml(spec,"DemoHost-1","VM Tier01"),expected);
}
