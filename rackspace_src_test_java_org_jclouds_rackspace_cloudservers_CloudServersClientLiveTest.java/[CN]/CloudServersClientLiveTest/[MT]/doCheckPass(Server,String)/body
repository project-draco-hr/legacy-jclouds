{
  InetSocketAddress socket=new InetSocketAddress(Iterables.get(newDetails.getAddresses().getPublicAddresses(),0),22);
  socketTester.apply(socket);
  SshClient client=sshFactory.create(socket,"root",pass);
  try {
    client.connect();
    InputStream etcPasswd=client.get("/etc/jclouds.txt");
    String etcPasswdContents=Utils.toStringAndClose(etcPasswd);
    assertEquals("rackspace",etcPasswdContents.trim());
  }
  finally {
    if (client != null)     client.disconnect();
  }
}
