{
  if (args.length < PARAMETERS)   throw new IllegalArgumentException(INVALID_SYNTAX);
  boolean isEnterprise=System.getProperties().containsKey("jclouds.enterprise");
  String accesskeyid=args[0];
  String secretkey=args[1];
  String queueName=args[2];
  int messageCount=Integer.parseInt(args[3]);
  RestContext<SQSAsyncClient,SQSClient> context=isEnterprise ? SQSContextFactory.createContext(accesskeyid,secretkey,new NullLoggingModule(),new EnterpriseConfigurationModule()) : SQSContextFactory.createContext(accesskeyid,secretkey,new NullLoggingModule());
  try {
    Set<Queue> queues=Sets.newHashSet();
    if (purgeQueues(queueName,context)) {
      System.out.printf("pausing 60 seconds before recreating queues%n");
      Thread.sleep(60 * 1000);
    }
    createQueues(queueName,context,queues);
    runTests(messageCount,isEnterprise ? "enterprise" : "default",context,queues);
  }
  finally {
    purgeQueues(queueName,context);
    context.close();
    System.exit(0);
  }
}
