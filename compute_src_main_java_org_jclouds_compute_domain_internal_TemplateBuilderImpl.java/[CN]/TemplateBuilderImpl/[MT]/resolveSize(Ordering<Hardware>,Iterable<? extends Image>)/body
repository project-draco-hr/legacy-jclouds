{
  Set<? extends Hardware> hardwarel=hardwares.get();
  Hardware hardware;
  try {
    Iterable<? extends Hardware> hardwaresThatAreCompatibleWithOurImages=filter(hardwarel,new Predicate<Hardware>(){
      @Override public boolean apply(      final Hardware hardware){
        return Iterables.any(images,new Predicate<Image>(){
          @Override public boolean apply(          Image input){
            return hardware.supportsImage().apply(input);
          }
          @Override public String toString(){
            return "hardware(" + hardware + ").supportsImage()";
          }
        }
);
      }
    }
);
    hardware=hardwareOrdering.max(filter(hardwaresThatAreCompatibleWithOurImages,hardwarePredicate));
  }
 catch (  NoSuchElementException exception) {
    throw new NoSuchElementException("hardware don't support any images: " + toString() + "\n"+ hardwarel+ "\n"+ images);
  }
  logger.debug("<<   matched hardware(%s)",hardware);
  return hardware;
}
