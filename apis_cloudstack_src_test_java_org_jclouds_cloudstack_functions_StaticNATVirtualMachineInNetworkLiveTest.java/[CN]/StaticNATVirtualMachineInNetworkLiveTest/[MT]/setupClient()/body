{
  super.setupContext();
  prefix+="nat";
  try {
    network=find(client.getNetworkClient().listNetworks(),NetworkPredicates.supportsStaticNAT());
    Long defaultTemplate=(imageId != null && !"".equals(imageId)) ? new Long(imageId) : null;
    vm=VirtualMachineClientLiveTest.createVirtualMachineInNetwork(network,defaultTemplateOrPreferredInZone(defaultTemplate,client,network.getZoneId()),client,jobComplete,virtualMachineRunning);
    if (vm.getPassword() != null && !loginCredentials.hasPasswordOption())     loginCredentials=loginCredentials.toBuilder().password(vm.getPassword()).build();
  }
 catch (  NoSuchElementException e) {
    networksDisabled=true;
  }
}
