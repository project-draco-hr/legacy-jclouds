{
  int allocatedCount=0;
  Set<NodeMetadata> allocatedNodes=Sets.newLinkedHashSet();
  for (  NodeMetadata metadata : groupMapping.keySet()) {
    if (groupMapping.get(metadata).equals("unassigned")) {
      groupMapping.put(metadata,"group");
      NodeMetadata nodeWithUpdatedGroup=NodeMetadataBuilder.fromNodeMetadata(metadata).group(group).build();
      allocatedNodes.add(nodeWithUpdatedGroup);
      allocatedCount+=1;
      if (allocatedCount == count)       break;
    }
  }
  return allocatedNodes;
}
