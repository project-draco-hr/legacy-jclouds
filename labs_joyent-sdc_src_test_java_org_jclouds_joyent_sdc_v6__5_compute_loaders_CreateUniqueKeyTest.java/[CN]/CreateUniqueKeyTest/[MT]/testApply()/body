{
  SDCClient sdcClient=createMock(SDCClient.class);
  KeyClient keyClient=createMock(KeyClient.class);
  Crypto crypto=createMock(Crypto.class);
  KeyPairGenerator rsaKeyPairGenerator=createMock(KeyPairGenerator.class);
  SecureRandom secureRandom=createMock(SecureRandom.class);
  Key key=Key.builder().name("group-foo").key(openSshKey).build();
  expect(crypto.rsaKeyPairGenerator()).andReturn(rsaKeyPairGenerator);
  rsaKeyPairGenerator.initialize(2048,secureRandom);
  expect(rsaKeyPairGenerator.genKeyPair()).andReturn(keyPair);
  expect(sdcClient.getKeyClient()).andReturn(keyClient);
  expect(keyClient.create(key)).andReturn(key);
  replay(sdcClient,keyClient,crypto,rsaKeyPairGenerator,secureRandom);
  CreateUniqueKey parser=new CreateUniqueKey(sdcClient,namingConvention,crypto,Providers.of(secureRandom));
  assertEquals(parser.load(DatacenterAndName.fromDatacenterAndName("datacenter","group")),KeyAndPrivateKey.fromKeyAndPrivateKey(key,PRIVATE_KEY));
  verify(sdcClient,keyClient,crypto,rsaKeyPairGenerator,secureRandom);
}
