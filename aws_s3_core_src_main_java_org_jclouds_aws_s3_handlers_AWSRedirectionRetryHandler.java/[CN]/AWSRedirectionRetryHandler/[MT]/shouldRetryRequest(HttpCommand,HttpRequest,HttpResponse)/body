{
  byte[] content=Utils.closeConnectionButKeepContentStream(response);
  if (request.getMethod() == HttpMethod.HEAD) {
    command.setMethod(HttpMethod.GET);
    return true;
  }
 else {
    command.incrementRedirectCount();
    try {
      AWSError error=utils.parseAWSErrorFromContent(parserFactory,command,response,new String(content));
      String host=error.getDetails().get(S3Constants.ENDPOINT);
      if (host != null) {
        if (host.equals(request.getEndpoint().getHost())) {
          return backoffHandler.shouldRetryRequest(command,response);
        }
 else {
          command.setHostAndPort(host,request.getEndpoint().getPort());
        }
        return true;
      }
 else {
        return false;
      }
    }
 catch (    HttpException e) {
      logger.error(e,"error on redirect for command %s; response %s; retrying...",command,response);
      return false;
    }
  }
}
