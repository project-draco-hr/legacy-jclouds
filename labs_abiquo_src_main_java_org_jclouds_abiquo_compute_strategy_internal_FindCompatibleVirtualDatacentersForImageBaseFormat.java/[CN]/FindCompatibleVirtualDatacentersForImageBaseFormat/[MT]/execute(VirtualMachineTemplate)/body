{
  DatacenterDto datacenterDto=new DatacenterDto();
  datacenterDto.setId(template.unwrap().getIdFromLink(ParentLinkName.DATACENTER_REPOSITORY));
  Datacenter datacenter=wrap(context,Datacenter.class,datacenterDto);
  Iterable<VirtualDatacenter> vdcs=cloudService.listVirtualDatacenters(VirtualDatacenterPredicates.datacenter(datacenter));
  return filter(vdcs,new Predicate<VirtualDatacenter>(){
    @Override public boolean apply(    final VirtualDatacenter vdc){
      HypervisorType type=vdc.getHypervisorType();
      return type.isCompatible(template.getDiskFormatType());
    }
  }
);
}
