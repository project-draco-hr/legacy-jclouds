{
  InputStream is=getClass().getResourceAsStream("/bluelock/vdc.xml");
  Injector injector=Guice.createInjector(new SaxParserModule());
  Factory factory=injector.getInstance(ParseSax.Factory.class);
  VDC vdc=factory.create(injector.getInstance(VDCHandler.class)).parse(is);
  VCloudClient client=createMock(VCloudClient.class);
  FindLocationForResource findLocationForResourceInVDC=createMock(FindLocationForResource.class);
  ParseVAppTemplatesInVDCToSizeProvider providerParser=new ParseVAppTemplatesInVDCToSizeProvider(client,findLocationForResourceInVDC);
  expect(findLocationForResourceInVDC.apply((NamedResource)anyObject())).andReturn(null).atLeastOnce();
  replay(client);
  replay(findLocationForResourceInVDC);
  Set<Size> sizes=Sets.newLinkedHashSet();
  providerParser.addSizesFromVAppTemplatesInVDC(vdc,sizes);
  assertEquals(sizes.size(),vdc.getResourceEntities().size());
  assertEquals(Iterables.get(sizes,0),new SizeImpl("https://express3.bluelock.com/api/v0.8/vAppTemplate/396","4CPUx2GBx20GB","https://express3.bluelock.com/api/v0.8/vAppTemplate/396",null,null,ImmutableMap.<String,String>of(),4.0,2048,20,ImagePredicates.idEquals("https://express3.bluelock.com/api/v0.8/vAppTemplate/396")));
  assertEquals(Iterables.get(sizes,116),new SizeImpl("https://express3.bluelock.com/api/v0.8/vAppTemplate/434","1CPUx512MBx40GB","https://express3.bluelock.com/api/v0.8/vAppTemplate/434",null,null,ImmutableMap.<String,String>of(),1.0,512,40,ImagePredicates.idEquals("https://express3.bluelock.com/api/v0.8/vAppTemplate/434")));
  assertEquals(Iterables.getLast(sizes),new SizeImpl("https://express3.bluelock.com/api/v0.8/vAppTemplate/383","1CPUx1GBx20GB","https://express3.bluelock.com/api/v0.8/vAppTemplate/383",null,null,ImmutableMap.<String,String>of(),1.0,1024,20,ImagePredicates.idEquals("https://express3.bluelock.com/api/v0.8/vAppTemplate/383")));
  verify(client);
  verify(findLocationForResourceInVDC);
}
