{
  String paramsString=null;
  int queryIndex=request.getUri().indexOf('?');
  if (queryIndex >= 0) {
    toSign.append(request.getUri().substring(0,queryIndex));
    paramsString=request.getUri().substring(queryIndex + 1);
  }
 else {
    toSign.append(request.getUri());
  }
  if (paramsString != null) {
    StringBuilder paramsToSign=new StringBuilder("?");
    String[] params=paramsString.split("&");
    for (    String param : params) {
      String[] paramNameAndValue=param.split("=");
      if ("acl".equals(paramNameAndValue[0])) {
        paramsToSign.append("acl");
      }
    }
    if (paramsToSign.length() > 1) {
      toSign.append(paramsToSign);
    }
  }
}
