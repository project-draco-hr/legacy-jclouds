{
  useDefaultPortIfNotPresent(properties);
  addLoggingModuleIfNotPresent(modules);
  addS3ParserModuleIfNotPresent(modules);
  addS3ConnectionModuleIfNotPresent(modules);
  addHttpModuleIfNeededAndNotPresent(modules);
  modules.add(new AbstractModule(){
    @Override protected void configure(){
      Names.bindProperties(binder(),checkNotNull(properties,"properties"));
    }
  }
);
  modules.add(new S3ContextModule());
  return Guice.createInjector(modules);
}
