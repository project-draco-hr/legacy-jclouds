{
  ISession session=machineUtils.sharedLockMachineAndApplyToSession(vmName,new Function<ISession,ISession>(){
    @Override public ISession apply(    ISession session){
      IProgress powerdownIProgress=session.getConsole().powerDown();
      powerdownIProgress.waitForCompletion(-1);
      return session;
    }
  }
);
  return checkNotNull(session,"session");
}
