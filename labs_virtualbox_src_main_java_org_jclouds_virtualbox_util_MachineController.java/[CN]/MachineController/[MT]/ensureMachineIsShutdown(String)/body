{
  ISession session=machineUtils.sharedLockMachineAndApplyToSession(vmName,new Function<ISession,ISession>(){
    @Override public ISession apply(    ISession session){
      session.getConsole().powerButton();
      return session;
    }
  }
);
  checkState(retry(new MachineStatePredicate(manager.get().getVBox(),vmName),15,3,SECONDS).apply(MachineState.PoweredOff),"vm(%s) is not shutdown correctly",vmName);
  return checkNotNull(session,"session");
}
