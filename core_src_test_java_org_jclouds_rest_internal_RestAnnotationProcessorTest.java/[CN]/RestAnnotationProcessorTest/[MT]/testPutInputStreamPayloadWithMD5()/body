{
  Payload payload=newInputStreamPayload(toInputStream("whoops"));
  payload.setContentLength((long)"whoops".length());
  payload.setContentMD5(injector.getInstance(EncryptionService.class).md5(toInputStream("whoops")));
  Method method=TestTransformers.class.getMethod("put",Payload.class);
  HttpRequest request=factory(TestQuery.class).createRequest(method,payload);
  assertRequestLineEquals(request,"PUT http://localhost:9999?x-ms-version=2009-07-17 HTTP/1.1");
  assertHeadersEqual(request,"Content-Length: 6\nContent-MD5: 2M+SrvaXyLZujY8rtQVwMQ==\nContent-Type: application/unknown\n");
  assertPayloadEquals(request,"whoops");
}
