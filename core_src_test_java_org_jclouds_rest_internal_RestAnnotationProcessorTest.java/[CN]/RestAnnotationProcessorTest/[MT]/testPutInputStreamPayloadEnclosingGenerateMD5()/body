{
  Method method=TestTransformers.class.getMethod("put",PayloadEnclosing.class);
  PayloadEnclosing payloadEnclosing=new PayloadEnclosingImpl(newInputStreamPayload(toInputStream("whoops")));
  encryptionService.generateMD5BufferingIfNotRepeatable(payloadEnclosing);
  HttpRequest request=factory(TestQuery.class).createRequest(method,payloadEnclosing);
  assertRequestLineEquals(request,"PUT http://localhost:9999?x-ms-version=2009-07-17 HTTP/1.1");
  assertNonPayloadHeadersEqual(request,"");
  assertPayloadEquals(request,"whoops","application/unknown",true);
}
