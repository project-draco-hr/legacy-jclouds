{
  INetworkAdapter iNetworkAdapter=machine.getNetworkAdapter(networkInterfaceCard.getSlot());
  for (  String redirectRule : iNetworkAdapter.getNATEngine().getRedirects()) {
    String redirectRuleName=Iterables.getFirst(Splitter.on(",").split(redirectRule),null);
    if (redirectRuleName != null) {
      iNetworkAdapter.getNATEngine().removeRedirect(redirectRuleName);
    }
  }
  iNetworkAdapter.setAttachmentType(NAT);
  for (  RedirectRule rule : networkInterfaceCard.getNetworkAdapter().getRedirectRules()) {
    try {
      String ruleName=String.format("%s@%s:%s->%s:%s",rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
      iNetworkAdapter.getNATEngine().addRedirect(ruleName,rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
    }
 catch (    VBoxException e) {
      if (!e.getMessage().contains("already exists"))       throw e;
    }
  }
  iNetworkAdapter.setEnabled(networkInterfaceCard.isEnabled());
  machine.saveSettings();
  return null;
}
