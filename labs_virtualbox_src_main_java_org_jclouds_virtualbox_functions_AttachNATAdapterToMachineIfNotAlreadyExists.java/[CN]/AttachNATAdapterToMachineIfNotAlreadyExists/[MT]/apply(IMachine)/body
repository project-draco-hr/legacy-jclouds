{
  INetworkAdapter iNetworkAdapter=machine.getNetworkAdapter(networkInterfaceCard.getSlot());
  iNetworkAdapter.setAttachmentType(NAT);
  for (  RedirectRule rule : networkInterfaceCard.getNetworkAdapter().getRedirectRules()) {
    try {
      String ruleName=String.format("%s@%s:%s->%s:%s",rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
      iNetworkAdapter.getNatDriver().addRedirect(ruleName,rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
    }
 catch (    VBoxException e) {
      if (!e.getMessage().contains("already exists"))       throw e;
    }
  }
  iNetworkAdapter.setEnabled(true);
  machine.saveSettings();
  return null;
}
