{
  if (getResponse().getStatusCode() == 200) {
    S3Object.Metadata metaData=new S3Object.Metadata(key);
    extractUserMetadata(metaData);
    addMd5(metaData);
    metaData.setLastModified(dateParser.dateTimeFromHeaderFormat(getResponse().getFirstHeaderOrNull(HttpHeaders.LAST_MODIFIED)));
    metaData.setContentType(getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_TYPE));
    metaData.setSize(Long.parseLong(getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_LENGTH)));
    metaData.setCacheControl(getResponse().getFirstHeaderOrNull(HttpHeaders.CACHE_CONTROL));
    metaData.setContentDisposition(getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_DISPOSITION));
    metaData.setContentEncoding(getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_ENCODING));
    return metaData;
  }
 else   if (getResponse().getStatusCode() == 404) {
    return S3Object.Metadata.NOT_FOUND;
  }
 else {
    String reason=null;
    try {
      reason=Utils.toStringAndClose(getResponse().getContent());
    }
 catch (    IOException e) {
      logger.error(e,"error parsing reason");
    }
    throw new HttpException("Error parsing object " + getResponse() + " reason: "+ reason);
  }
}
