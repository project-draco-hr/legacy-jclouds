{
  HMac hmac=new HMac(digest);
  byte[] resBuf=new byte[hmac.getMacSize()];
  byte[] plainBytes=Utils.encodeString(toEncode);
  byte[] keyBytes=key;
  hmac.init(new KeyParameter(keyBytes));
  hmac.update(plainBytes,0,plainBytes.length);
  hmac.doFinal(resBuf,0);
  return toBase64String(resBuf);
}
