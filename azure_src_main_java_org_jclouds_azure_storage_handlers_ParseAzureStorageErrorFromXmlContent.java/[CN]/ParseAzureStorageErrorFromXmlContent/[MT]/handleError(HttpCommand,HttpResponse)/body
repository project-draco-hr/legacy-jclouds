{
  byte[] content;
  try {
    content=response.getContent() != null ? ByteStreams.toByteArray(response.getContent()) : null;
    if (content != null) {
      String message=new String(content);
      try {
        if (message.indexOf('<') >= 0) {
          AzureStorageError error=utils.parseAzureStorageErrorFromContent(command,response,new ByteArrayInputStream(content));
          AzureStorageResponseException ex=new AzureStorageResponseException(command,response,error);
          if (error.getCode().equals("ContainerNotFound")) {
            command.setException(new ContainerNotFoundException(ex));
          }
 else {
            command.setException(ex);
          }
        }
 else {
          command.setException(new HttpResponseException(command,response,message));
        }
      }
 catch (      Exception he) {
        command.setException(new HttpResponseException(command,response,message));
        Throwables.propagateIfPossible(he);
      }
    }
 else {
      command.setException(new HttpResponseException(command,response));
    }
  }
 catch (  Exception e) {
    command.setException(new HttpResponseException(command,response));
    Throwables.propagateIfPossible(e);
  }
 finally {
    Closeables.closeQuietly(response.getContent());
  }
}
