{
  String bucketName=getBucketName();
  String destinationBucket=getScratchBucketName();
  try {
    addToBucketAndValidate(bucketName,sourceKey);
    Multimap<String,String> metadata=HashMultimap.create();
    metadata.put(S3Headers.USER_METADATA_PREFIX + "adrian","cole");
    client.copyObject(bucketName,sourceKey,destinationBucket,destinationKey,overrideMetadataWith(metadata)).get(10,TimeUnit.SECONDS);
    validateContent(destinationBucket,destinationKey);
    S3Object.Metadata objectMeta=client.headObject(destinationBucket,destinationKey).get(10,TimeUnit.SECONDS);
    assertEquals(objectMeta.getUserMetadata(),metadata);
  }
  finally {
    returnBucket(bucketName);
    returnScratchBucket(destinationBucket);
  }
}
