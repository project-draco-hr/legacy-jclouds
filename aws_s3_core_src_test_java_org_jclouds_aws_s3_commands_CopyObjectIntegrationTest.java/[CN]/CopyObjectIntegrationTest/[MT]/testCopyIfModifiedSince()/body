{
  String destinationBucket=bucketName + "dest";
  DateTime before=new DateTime();
  addToBucketAndValidate(bucketName,sourceKey);
  DateTime after=new DateTime().plusSeconds(1);
  createBucketAndEnsureEmpty(destinationBucket);
  client.copyObject(bucketName,sourceKey,destinationBucket,destinationKey,ifSourceModifiedSince(before)).get(10,TimeUnit.SECONDS);
  validateContent(destinationBucket,destinationKey);
  try {
    client.copyObject(bucketName,sourceKey,destinationBucket,destinationKey,ifSourceModifiedSince(after)).get(10,TimeUnit.SECONDS);
  }
 catch (  ExecutionException e) {
    HttpResponseException ex=(HttpResponseException)e.getCause();
    assertEquals(ex.getResponse().getStatusCode(),412);
  }
}
