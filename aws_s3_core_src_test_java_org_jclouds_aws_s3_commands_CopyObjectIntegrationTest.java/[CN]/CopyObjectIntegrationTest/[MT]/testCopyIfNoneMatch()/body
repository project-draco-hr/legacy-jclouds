{
  String bucketName=getBucketName();
  String destinationBucket=getScratchBucketName();
  try {
    addToBucketAndValidate(bucketName,sourceKey);
    client.copyObject(bucketName,sourceKey,destinationBucket,destinationKey,ifSourceMd5DoesntMatch(badMd5)).get(10,TimeUnit.SECONDS);
    validateContent(destinationBucket,destinationKey);
    try {
      client.copyObject(bucketName,sourceKey,destinationBucket,destinationKey,ifSourceMd5DoesntMatch(goodMd5)).get(10,TimeUnit.SECONDS);
    }
 catch (    ExecutionException e) {
      HttpResponseException ex=(HttpResponseException)e.getCause();
      assertEquals(ex.getResponse().getStatusCode(),412);
    }
  }
  finally {
    returnBucket(bucketName);
    returnScratchBucket(destinationBucket);
  }
}
