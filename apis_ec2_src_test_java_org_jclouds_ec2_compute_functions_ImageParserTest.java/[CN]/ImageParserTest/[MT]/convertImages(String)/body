{
  Map<OsFamily,Map<String,String>> map=new BaseComputeServiceContextModule(){
  }
.provideOsVersionMap(new ComputeServiceConstants.ReferenceData(),Guice.createInjector(new GsonModule()).getInstance(Json.class));
  Set<Image> result=DescribeImagesResponseHandlerTest.parseImages(resource);
  ImageParser parser=new ImageParser(new EC2PopulateDefaultLoginCredentialsForImageStrategy(),map,Suppliers.<Set<? extends Location>>ofInstance(ImmutableSet.<Location>of(defaultLocation)),Suppliers.ofInstance(defaultLocation),"ec2");
  return Sets.newLinkedHashSet(Iterables.filter(Iterables.transform(result,parser),Predicates.notNull()));
}
