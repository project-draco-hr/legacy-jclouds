{
  DomainClient client=requestSendsResponse(HttpRequest.builder().method("POST").endpoint(URI.create("https://api.glesys.com/domain/add/format/json")).headers(ImmutableMultimap.<String,String>builder().put("Accept","application/json").put("Authorization","Basic aWRlbnRpdHk6Y3JlZGVudGlhbA==").build()).payload(newUrlEncodedFormPayload(ImmutableMultimap.<String,String>builder().put("domainname","cl66666_x").put("primarynameserver","ns1.somewhere.x").put("expire","1").put("minimum","1").put("refresh","1").put("responsibleperson","Tester.").put("retry","1").put("ttl","1").build())).build(),HttpResponse.builder().statusCode(200).payload(payloadFromResourceWithContentType("/domain_details.json",MediaType.APPLICATION_JSON)).build()).getDomainClient();
  AddDomainOptions options=(AddDomainOptions)AddDomainOptions.Builder.primaryNameServer("ns1.somewhere.x").expire(1).minimum(1).refresh(1).responsiblePerson("Tester").retry(1).ttl(1);
  assertEquals(client.addDomain("cl66666_x",options),domainInDomainDetails());
}
