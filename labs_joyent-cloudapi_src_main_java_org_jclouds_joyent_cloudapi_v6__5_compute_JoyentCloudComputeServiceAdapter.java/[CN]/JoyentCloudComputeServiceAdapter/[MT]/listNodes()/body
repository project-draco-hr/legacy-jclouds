{
  Builder<MachineInDatacenter> builder=ImmutableSet.builder();
  for (  final String datacenterId : datacenterIds.get()) {
    builder.addAll(transform(cloudApiApi.getMachineApiForDatacenter(datacenterId).list(),new Function<Machine,MachineInDatacenter>(){
      @Override public MachineInDatacenter apply(      Machine arg0){
        return new MachineInDatacenter(arg0,datacenterId);
      }
    }
));
  }
  return builder.build();
}
