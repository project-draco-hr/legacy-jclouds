{
  final Date date=new Date();
  Supplier<Date> dateSupplier=new Supplier<Date>(){
    @Override public Date get(){
      return date;
    }
  }
;
  GeneratedHttpRequest<?> request=createMock(GeneratedHttpRequest.class);
  request.addQueryParam("now",date.getTime() + "");
  replay(request);
  AddTimestampQuery filter=new AddTimestampQuery(dateSupplier);
  filter.filter(request);
}
