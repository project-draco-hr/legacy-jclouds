{
  InputStream is=getClass().getResourceAsStream("/terremark/get_vapp.xml");
  VCloudExpressVApp result=(VCloudExpressVApp)factory.create(injector.getInstance(VCloudExpressVAppHandler.class)).parse(is);
  assertEquals(result.getName(),"centos-53");
  assertEquals(result.getStatus(),Status.OFF);
  assertEquals(result.getSize().longValue(),10485760);
  assertEquals(result.getOperatingSystemDescription(),"Red Hat Enterprise Linux 5 (64-bit)");
  assertEquals(result.getHref(),URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vapp/16238"));
  assertEquals(result.getVDC(),new ReferenceTypeImpl(null,VCloudExpressMediaType.VDC_XML,URI.create("https://services.vcloudexpress.terremark.com/api/v0.8/vdc/32")));
  assertEquals(result.getSystem(),new VirtualSystem(0,"Virtual Hardware Family","centos-53","vmx-07"));
  assertEquals(result.getNetworkToAddresses().get("Internal"),ImmutableList.<String>of("10.114.34.132"));
  ResourceAllocation cpu=new ResourceAllocation(1,"1 virtual CPU(s)","Number of Virtual CPUs",ResourceType.PROCESSOR,null,null,null,null,null,null,1,"hertz * 10^6");
  ResourceAllocation controller=new ResourceAllocation(3,"SCSI Controller 0","SCSI Controller",ResourceType.SCSI_CONTROLLER,"lsilogic",null,0,null,null,null,1,null);
  ResourceAllocation memory=new ResourceAllocation(2,"512MB of memory","Memory Size",ResourceType.MEMORY,null,null,null,null,null,null,512,"byte * 2^20");
  ResourceAllocation disk=new ResourceAllocation(9,"Hard Disk 1",null,ResourceType.DISK_DRIVE,null,"10485760",null,0,3,null,10485760,"byte * 2^20");
  assertEquals(result.getResourceAllocations(),ImmutableSet.of(cpu,memory,controller,disk));
  assertEquals(find(result.getResourceAllocations(),resourceType(ResourceType.PROCESSOR)).getVirtualQuantity(),1);
  assertEquals(find(result.getResourceAllocations(),resourceType(ResourceType.SCSI_CONTROLLER)).getVirtualQuantity(),1);
  assertEquals(find(result.getResourceAllocations(),resourceType(ResourceType.MEMORY)).getVirtualQuantity(),512);
  assertEquals(find(result.getResourceAllocations(),resourceType(ResourceType.DISK_DRIVE)).getVirtualQuantity(),10485760);
  assertEquals(result.getSize().longValue(),find(result.getResourceAllocations(),resourceType(ResourceType.DISK_DRIVE)).getVirtualQuantity());
}
