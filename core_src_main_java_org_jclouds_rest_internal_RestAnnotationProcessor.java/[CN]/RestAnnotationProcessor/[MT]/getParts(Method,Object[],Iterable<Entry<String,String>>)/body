{
  List<Part> parts=newLinkedList();
  LoadingCache<Integer,Set<Annotation>> indexToPartParam=methodToIndexOfParamToPartParamAnnotations.get(method);
  for (  Entry<Integer,Set<Annotation>> entry : indexToPartParam.asMap().entrySet()) {
    for (    Annotation key : entry.getValue()) {
      PartParam param=(PartParam)key;
      PartOptions options=new PartOptions();
      if (!PartParam.NO_CONTENT_TYPE.equals(param.contentType()))       options.contentType(param.contentType());
      if (!PartParam.NO_FILENAME.equals(param.filename()))       options.filename(Strings2.replaceTokens(param.filename(),iterable));
      Object arg=args[entry.getKey()];
      Preconditions.checkNotNull(arg,param.name());
      Part part=Part.create(param.name(),newPayload(arg),options);
      parts.add(part);
    }
  }
  return parts;
}
