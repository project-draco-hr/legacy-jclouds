{
  checkState(data != null,"data");
  if (data instanceof InputStream) {
    Md5InputStreamResult result=S3Utils.generateMd5Result((InputStream)data);
    getMetadata().setSize(result.length);
    getMetadata().setMd5(result.md5);
    setData(result.data);
  }
 else {
    getMetadata().setMd5(S3Utils.md5(data));
  }
}
