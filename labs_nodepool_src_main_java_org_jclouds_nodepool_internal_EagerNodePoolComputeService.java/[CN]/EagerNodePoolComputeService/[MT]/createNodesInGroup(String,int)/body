{
  checkState(started.get(),"pool is not started");
  try {
    return assignPoolNodes(group,count);
  }
 catch (  Exception e) {
    Set<NodeMetadata> nodes=Collections.emptySet();
    Map<String,Exception> executionExceptions=ImmutableMap.of("poolnode",e);
    Map<NodeMetadata,Exception> failedNodes=ImmutableMap.of(new NodeMetadataBuilder().id("poolnode").status(Status.ERROR).build(),e);
    throw new RunNodesException(group,count,template,nodes,executionExceptions,failedNodes);
  }
}
