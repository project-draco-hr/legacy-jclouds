{
  final ChannelExec channel;
  session.setTimeout((int)maxwait);
  channel=(ChannelExec)session.openChannel("exec");
  channel.setCommand(cmd);
  attachStreams(channel);
  project.log("executing command: " + cmd,Project.MSG_VERBOSE);
  channel.connect();
  try {
    waitFor(channel);
  }
  finally {
    streamHandler.stop();
    closeStreams(channel);
  }
  return channel.getExitStatus();
}
