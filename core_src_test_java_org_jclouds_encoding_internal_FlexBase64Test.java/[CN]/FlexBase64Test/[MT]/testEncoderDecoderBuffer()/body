{
  byte[] nums=new byte[32768];
  for (int i=0; i < 32768; i++) {
    nums[i]=(byte)(i % 255);
  }
  ByteBuffer source=ByteBuffer.wrap(nums);
  ByteBuffer target=ByteBuffer.allocate(65535);
  FlexBase64.Encoder encoder=FlexBase64.createEncoder(true);
  encoder.encode(source,target);
  encoder.complete(target);
  ByteBuffer decoded=ByteBuffer.allocate(nums.length);
  FlexBase64.Decoder decoder=FlexBase64.createDecoder();
  target.flip();
  decoder.decode(target,decoded);
  decoded.flip();
  Assert.assertEquals(nums.length,decoded.remaining());
  for (int i=0; i < nums.length; i++) {
    Assert.assertEquals(nums[i],decoded.get());
  }
}
