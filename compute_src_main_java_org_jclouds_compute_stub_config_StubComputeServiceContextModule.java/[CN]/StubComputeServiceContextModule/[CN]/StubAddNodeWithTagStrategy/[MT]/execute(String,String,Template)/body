{
  checkArgument(location.equals(template.getLocation()),"invalid location: " + template.getLocation());
  int id=idProvider.get();
  StubNodeMetadata node=new StubNodeMetadata(id + "",name,id + "",location,null,ImmutableMap.<String,String>of(),tag,template.getImage(),NodeState.PENDING,ImmutableSet.<String>of(publicIpPrefix + id),ImmutableSet.<String>of(privateIpPrefix + id),ImmutableMap.<String,String>of(),new Credentials("root",passwordPrefix + id),service);
  node.setState(NodeState.RUNNING,100);
  nodes.put(id,node);
  return node;
}
