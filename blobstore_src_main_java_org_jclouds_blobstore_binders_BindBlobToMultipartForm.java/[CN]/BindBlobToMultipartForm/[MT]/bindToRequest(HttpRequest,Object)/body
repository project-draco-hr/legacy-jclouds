{
  Blob object=(Blob)payload;
  File file=new File(object.getMetadata().getName());
  Multimap<String,String> partHeaders=ImmutableMultimap.of("Content-Disposition",String.format("form-data; name=\"%s\"; filename=\"%s\"",file.getName(),file.getName()),HttpHeaders.CONTENT_TYPE,checkNotNull(object.getMetadata().getContentType(),"object.metadata.contentType()"));
  Object data=checkNotNull(object.getPayload(),"object.getPayload()").getRawContent();
  Part part;
  try {
    if (data instanceof byte[]) {
      part=new Part(partHeaders,(byte[])data);
    }
 else     if (data instanceof String) {
      part=new Part(partHeaders,(String)data);
    }
 else     if (data instanceof File) {
      part=new Part(partHeaders,(File)data);
    }
 else     if (data instanceof InputStream) {
      part=new Part(partHeaders,(InputStream)data,object.getContentLength());
    }
 else {
      throw new IllegalArgumentException("type of part not supported: " + data.getClass().getCanonicalName() + "; "+ object);
    }
  }
 catch (  FileNotFoundException e) {
    throw new IllegalArgumentException("file for part not found: " + object);
  }
  MultipartForm form=new MultipartForm(BOUNDARY,part);
  request.setPayload(form.getData());
  request.getHeaders().put(HttpHeaders.CONTENT_TYPE,"multipart/form-data; boundary=" + BOUNDARY);
  request.getHeaders().put(HttpHeaders.CONTENT_LENGTH,form.getSize() + "");
}
