{
  if (signatureOrMacAlgorithm.equals(NO_ALGORITHM)) {
    this.signatureOrMacFunction=new Function<byte[],byte[]>(){
      @Override public byte[] apply(      byte[] input){
        return null;
      }
    }
;
  }
 else   if (signatureOrMacAlgorithm.startsWith("SHA")) {
    this.signatureOrMacFunction=new SignatureGenerator(signatureOrMacAlgorithm,credentials.get().privateKey);
  }
 else {
    this.signatureOrMacFunction=new MessageAuthenticationCodeGenerator(signatureOrMacAlgorithm,credentials.get().privateKey);
  }
}
