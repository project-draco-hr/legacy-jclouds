{
  NewServerResponse serverResponse=client.createServer(name,checkNotNull(template.getImage().getId(),"imageId"),checkNotNull(template.getSize().getId(),"sizeId"));
  serverRunning.apply(serverResponse.getServer());
  Server server=client.getServer(serverResponse.getServer().getId());
  NodeMetadata node=new NodeMetadataImpl(server.getId().toString(),name,template.getLocation().getId(),null,ImmutableMap.<String,String>of(),tag,runningStateToNodeState.get(server.getState()),getPublicAddresses.apply(server),ImmutableList.<InetAddress>of(),ImmutableMap.<String,String>of(),new Credentials("root",serverResponse.getNewInstanceRequest().getCreateOptions().getPassword()));
  return node;
}
