{
  String keyPassword=checkNotNull(in.credential,"credential supplier returned null for credential (keyPassword)");
  try {
    Signature signer=Signature.getInstance(signatureMethod);
    KeyStore keyStore=checkNotNull(this.keyStore.get(),"keyStore");
    String alias=keyStore.aliases().nextElement();
    PrivateKey privateKey=(PrivateKey)keyStore.getKey(alias,keyPassword.toCharArray());
    signer.initSign(privateKey);
    return signer;
  }
 catch (  NoSuchAlgorithmException e) {
    throw propagate(e);
  }
catch (  KeyStoreException e) {
    throw propagate(e);
  }
catch (  UnrecoverableKeyException e) {
    throw propagate(e);
  }
catch (  InvalidKeyException e) {
    throw propagate(e);
  }
}
