{
  Iterable<? extends StorageMetadata> toDelete=Iterables.filter(listing,new Predicate<StorageMetadata>(){
    @Override public boolean apply(    StorageMetadata input){
switch (input.getType()) {
case BLOB:
        return true;
case FOLDER:
case RELATIVE_PATH:
      if (options.isRecursive())       return true;
    break;
}
return false;
}
}
);
return toDelete;
}
