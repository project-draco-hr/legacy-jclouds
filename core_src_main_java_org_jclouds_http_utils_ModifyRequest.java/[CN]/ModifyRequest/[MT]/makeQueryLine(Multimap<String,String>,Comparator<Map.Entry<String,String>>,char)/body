{
  Iterator<Map.Entry<String,String>> pairs=((sorter == null) ? params.entries() : sortEntries(params.entries(),sorter)).iterator();
  StringBuilder formBuilder=new StringBuilder();
  while (pairs.hasNext()) {
    Map.Entry<String,String> pair=pairs.next();
    formBuilder.append(Strings2.urlEncode(pair.getKey(),skips));
    if (pair.getValue() != null && !pair.getValue().equals("")) {
      formBuilder.append("=");
      formBuilder.append(Strings2.urlEncode(pair.getValue(),skips));
    }
    if (pairs.hasNext())     formBuilder.append("&");
  }
  return formBuilder.toString();
}
