{
  RESTLink configLink=checkNotNull(target.searchLink(ParentLinkName.NETWORK_CONFIGURATIONS),ValidationErrors.MISSING_REQUIRED_LINK + ParentLinkName.NETWORK_CONFIGURATIONS);
  Iterables.removeIf(target.getLinks(),Predicates.or(LinkPredicates.isNic(),LinkPredicates.rel(ParentLinkName.NETWORK_GATEWAY)));
  int i=0;
  if (ips != null) {
    for (i=0; i < ips.size(); i++) {
      RESTLink source=LinkUtils.getSelfLink(ips.get(i).unwrap());
      RESTLink link=new RESTLink("nic" + i,source.getHref());
      link.setType(ips.get(i).unwrap().getBaseMediaType());
      target.addLink(link);
    }
  }
  if (unmanagetNetworks != null) {
    for (    UnmanagedNetwork unmanaged : unmanagetNetworks) {
      RESTLink source=checkNotNull(unmanaged.unwrap().searchLink("ips"),ValidationErrors.MISSING_REQUIRED_LINK + "ips");
      RESTLink link=new RESTLink("nic" + i,source.getHref());
      link.setType(UnmanagedIpDto.BASE_MEDIA_TYPE);
      target.addLink(link);
      i++;
    }
  }
  if (gatewayNetwork != null) {
    target.addLink(new RESTLink(ParentLinkName.NETWORK_GATEWAY,configLink.getHref() + "/" + gatewayNetwork.getId()));
  }
  return update(true);
}
