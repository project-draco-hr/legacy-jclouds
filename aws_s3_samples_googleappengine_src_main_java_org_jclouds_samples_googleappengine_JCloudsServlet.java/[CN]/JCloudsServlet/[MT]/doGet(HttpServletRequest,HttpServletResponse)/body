{
  try {
    SortedSet<BucketMetadata> myBucketMetadata=context.getApi().listOwnedBuckets();
    SortedSet<BucketResult> myBuckets=Sets.newTreeSet();
    for (    BucketMetadata metadata : myBucketMetadata) {
      BucketResult result=new BucketResult();
      result.setName(metadata.getName());
      try {
        try {
          ListBucketResponse bucket=context.getApi().listBucket(metadata.getName()).get(10,TimeUnit.SECONDS);
          result.setSize(bucket.size() + "");
        }
 catch (        ContainerNotFoundException ex) {
          result.setStatus("not found");
        }
      }
 catch (      Exception e) {
        logger.error(e,"Error listing bucket %1$s",result.getName());
        result.setStatus(e.getMessage());
      }
      myBuckets.add(result);
    }
    request.setAttribute("buckets",myBuckets);
    request.setAttribute("className",className);
    String nextJSP="/WEB-INF/jsp/buckets.jsp";
    RequestDispatcher dispatcher=getServletContext().getRequestDispatcher(nextJSP);
    dispatcher.forward(request,response);
  }
 catch (  Exception e) {
    logger.error(e,"Error listing buckets");
    throw new ServletException(e);
  }
}
