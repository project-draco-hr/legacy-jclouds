{
  if (sftp != null && sftp.isConnected())   return;
  JSch jsch=new JSch();
  session=null;
  Channel channel=null;
  try {
    session=jsch.getSession(username,host.getHostAddress(),port);
  }
 catch (  JSchException e) {
    throw new SshException(String.format("%s@%s:%d: Error creating session.",username,host.getHostAddress(),port),e);
  }
  logger.debug("%s@%s:%d: Session created.",username,host.getHostAddress(),port);
  session.setPassword(password);
  java.util.Properties config=new java.util.Properties();
  config.put("StrictHostKeyChecking","no");
  session.setConfig(config);
  try {
    session.connect();
  }
 catch (  JSchException e) {
    throw new SshException(String.format("%s@%s:%d: Error connecting to session.",username,host.getHostAddress(),port),e);
  }
  logger.debug("%s@%s:%d: Session connected.",username,host.getHostAddress(),port);
  logger.debug("%s@%s:%d: Opening sftp Channel.",username,host.getHostAddress(),port);
  try {
    channel=session.openChannel("sftp");
    channel.connect();
  }
 catch (  JSchException e) {
    throw new SshException(String.format("%s@%s:%d: Error connecting to sftp.",username,host.getHostAddress(),port),e);
  }
  sftp=(ChannelSftp)channel;
}
