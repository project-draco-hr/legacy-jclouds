{
  this.host=checkNotNull(socket,"socket").getAddress();
  checkArgument(socket.getPort() > 0,"ssh port must be greater then zero" + socket.getPort());
  checkArgument(password != null || privateKey != null,"you must specify a password or a key");
  this.port=socket.getPort();
  this.username=checkNotNull(username,"username");
  this.backoffLimitedRetryHandler=checkNotNull(backoffLimitedRetryHandler,"backoffLimitedRetryHandler");
  this.timeout=timeout;
  this.password=password;
  this.privateKey=privateKey;
  if (privateKey == null) {
    this.toString=String.format("%s:password@%s:%d",username,host,port);
  }
 else {
    String fingerPrint=fingerprintPrivateKey(new String(privateKey));
    String sha1=sha1PrivateKey(new String(privateKey));
    this.toString=String.format("%s:rsa[fingerprint(%s),sha1(%s)]@%s:%d",username,fingerPrint,sha1,host,port);
  }
}
