{
  String region=Region.AP_SOUTHEAST_1;
  String tag="tag";
  String userSuppliedPlacementGroup=null;
  boolean shouldAutomaticallyCreatePlacementGroup=false;
  CreateKeyPairPlacementAndSecurityGroupsAsNeededAndReturnRunOptions strategy=setupStrategy();
  EC2TemplateOptions options=createMock(EC2TemplateOptions.class);
  PlacementGroup placementGroup=createMock(PlacementGroup.class);
  expect(options.getPlacementGroup()).andReturn(userSuppliedPlacementGroup);
  expect(options.shouldAutomaticallyCreatePlacementGroup()).andReturn(shouldAutomaticallyCreatePlacementGroup);
  replay(options);
  replay(placementGroup);
  replayStrategy(strategy);
  assertEquals(strategy.createNewPlacementGroupUnlessUserSpecifiedOtherwise(region,tag,options),null);
  verify(options);
  verify(placementGroup);
  verifyStrategy(strategy);
}
