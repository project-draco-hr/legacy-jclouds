{
  NodeMetadata node=metadata instanceof NodeMetadata ? NodeMetadata.class.cast(metadata) : getNodeMetadataStrategy.execute(metadata);
  String region=getRegionFromNodeOrDefault.apply(node);
  ec2Client.getInstanceServices().terminateInstancesInRegion(region,node.getId());
  return instanceStateTerminated.apply(Iterables.getOnlyElement(Iterables.concat(ec2Client.getInstanceServices().describeInstancesInRegion(region,node.getId()))));
}
