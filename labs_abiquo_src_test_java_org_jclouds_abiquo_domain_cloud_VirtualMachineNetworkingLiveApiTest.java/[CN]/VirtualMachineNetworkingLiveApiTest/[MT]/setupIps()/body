{
  privateIp=env.privateNetwork.listUnusedIps().get(0);
  assertNotNull(privateIp);
  externalIp=env.externalNetwork.listUnusedIps().get(0);
  assertNotNull(externalIp);
  publicIpInfrastructure=env.virtualDatacenter.listAvailablePublicIps().get(0);
  env.virtualDatacenter.purchasePublicIp(publicIpInfrastructure);
  publicIpCloud=env.virtualDatacenter.findPurchasedPublicIp(IpPredicates.<PublicIp>address(publicIpInfrastructure.getIp()));
  assertNotNull(publicIpCloud);
}
