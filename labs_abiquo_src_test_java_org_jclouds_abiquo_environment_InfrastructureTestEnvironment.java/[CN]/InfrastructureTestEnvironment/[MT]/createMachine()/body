{
  String ip=Config.get("abiquo.hypervisor.address");
  HypervisorType type=HypervisorType.valueOf(Config.get("abiquo.hypervisor.type"));
  String user=Config.get("abiquo.hypervisor.user");
  String pass=Config.get("abiquo.hypervisor.pass");
  machine=datacenter.discoverSingleMachine(ip,type,user,pass);
  NetworkServiceType nst=datacenter.defaultNetworkServiceType();
  NetworkInterface vswitch=machine.findAvailableVirtualSwitch(Config.get("abiquo.hypervisor.vswitch"));
  vswitch.setNetworkServiceType(nst);
  Datastore datastore=machine.findDatastore(Config.get("abiquo.hypervisor.datastore"));
  datastore.setEnabled(true);
  machine.setRack(rack);
  machine.save();
  assertNotNull(machine.getId());
}
