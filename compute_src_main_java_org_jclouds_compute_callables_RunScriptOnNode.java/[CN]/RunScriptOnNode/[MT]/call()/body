{
  ssh.put(scriptName,script);
  ExecResponse returnVal=ssh.exec("chmod 755 " + scriptName);
  returnVal=ssh.exec("./" + scriptName + " init");
  logger.debug("<< initialized(%d)",returnVal.getExitCode());
  String command=(runAsRoot) ? runScriptAsRoot() : runScriptAsDefaultUser();
  returnVal=runCommand(command);
  logger.debug("<< start(%d)",returnVal.getExitCode());
  boolean complete=runScriptNotRunning.apply(new CommandUsingClient("./" + scriptName + " status",ssh));
  logger.debug("<< complete(%s)",complete);
  if (logger.isDebugEnabled() || returnVal.getExitCode() != 0) {
    logger.debug("<< stdout from %s as %s@%s\n%s",scriptName,node.getCredentials().identity,Iterables.get(node.getPublicAddresses(),0),ssh.exec("./" + scriptName + " tail").getOutput());
    logger.debug("<< stderr from %s as %s@%s\n%s",scriptName,node.getCredentials().identity,Iterables.get(node.getPublicAddresses(),0),ssh.exec("./" + scriptName + " tailerr").getOutput());
  }
  return returnVal;
}
