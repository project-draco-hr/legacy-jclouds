{
  List<VirtualMachineTemplate> templates=virtualDatacenter.listAvailableTemplates();
  assertFalse(templates.isEmpty());
  List<VirtualMachineTemplate> sorted=Lists.newArrayList(templates);
  Collections.sort(sorted,new Ordering<VirtualMachineTemplate>(){
    @Override public int compare(    final VirtualMachineTemplate left,    final VirtualMachineTemplate right){
      return Longs.compare(left.getDiskFileSize(),right.getDiskFileSize());
    }
  }
);
  template=sorted.get(0);
  virtualMachine=VirtualMachine.builder(context.getApiContext(),virtualAppliance,template).cpu(2).nameLabel(PREFIX + "VM Aloha").ram(128).build();
  virtualMachine.save();
  assertNotNull(virtualMachine.getId());
}
