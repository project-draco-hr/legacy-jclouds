{
  try {
    List<S3Bucket.Metadata> metadata=client.listOwnedBuckets().get(10,TimeUnit.SECONDS);
    List<Future<Boolean>> results=new ArrayList<Future<Boolean>>();
    for (    S3Bucket.Metadata metaDatum : metadata) {
      if (metaDatum.getName().startsWith(bucketPrefix.toLowerCase())) {
        S3Bucket bucket=client.listBucket(metaDatum.getName()).get(10,TimeUnit.SECONDS);
        for (        S3Object.Metadata objectMeta : bucket.getContents()) {
          results.add(client.deleteObject(metaDatum.getName(),objectMeta.getKey()));
        }
        Iterator<Future<Boolean>> iterator=results.iterator();
        while (iterator.hasNext()) {
          iterator.next().get(10,TimeUnit.SECONDS);
          iterator.remove();
        }
        client.deleteBucketIfEmpty(metaDatum.getName()).get(10,TimeUnit.SECONDS);
      }
    }
  }
 catch (  CancellationException e) {
    throw e;
  }
}
