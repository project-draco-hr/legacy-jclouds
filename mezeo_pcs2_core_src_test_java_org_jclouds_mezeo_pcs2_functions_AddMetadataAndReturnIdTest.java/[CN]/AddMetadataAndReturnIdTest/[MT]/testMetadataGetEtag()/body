{
  PCSUtil connection=createPCSUtil();
  AddMetadataAndReturnId function=new AddMetadataAndReturnId(fileCache,connection);
  PCSFile pcsFile=new PCSFile("key");
  pcsFile.getMetadata().getUserMetadata().put("foo","bar");
  pcsFile.getMetadata().getUserMetadata().put("biz","baz");
  function.setContext(factory.createRequest(method,"container",pcsFile,URI.create("http://localhost:8080")));
  response.setContent(IOUtils.toInputStream("http://localhost/contents/7F143552-AAF5-11DE-BBB0-0BC388ED913B"));
  String eTag=function.apply(response);
  assertEquals(eTag,"7F143552-AAF5-11DE-BBB0-0BC388ED913B");
  verify(connection);
}
