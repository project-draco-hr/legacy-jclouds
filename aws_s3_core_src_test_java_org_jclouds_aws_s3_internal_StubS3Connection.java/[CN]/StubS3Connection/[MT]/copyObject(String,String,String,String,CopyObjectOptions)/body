{
  final CopyObjectOptions options=(nullableOptions.length == 0) ? new CopyObjectOptions() : nullableOptions[0];
  return new FutureBase<ObjectMetadata>(){
    public ObjectMetadata get() throws InterruptedException, ExecutionException {
      Map<String,S3Object> source=getContainerToBlobs().get(sourceBucket);
      Map<String,S3Object> dest=getContainerToBlobs().get(destinationBucket);
      if (source.containsKey(sourceObject)) {
        S3Object object=source.get(sourceObject);
        if (options.getIfMatch() != null) {
          if (!Arrays.equals(object.getMetadata().getETag(),HttpUtils.fromHexString(options.getIfMatch().replaceAll("\"",""))))           throwResponseException(412);
        }
        if (options.getIfNoneMatch() != null) {
          if (Arrays.equals(object.getMetadata().getETag(),HttpUtils.fromHexString(options.getIfNoneMatch().replaceAll("\"",""))))           throwResponseException(412);
        }
        if (options.getIfModifiedSince() != null) {
          DateTime modifiedSince=dateService.rfc822DateParse(options.getIfModifiedSince());
          if (modifiedSince.isAfter(object.getMetadata().getLastModified()))           throwResponseException(412);
        }
        if (options.getIfUnmodifiedSince() != null) {
          DateTime unmodifiedSince=dateService.rfc822DateParse(options.getIfUnmodifiedSince());
          if (unmodifiedSince.isBefore(object.getMetadata().getLastModified()))           throwResponseException(412);
        }
        S3Object sourceS3=source.get(sourceObject);
        ObjectMetadata newMd=copy(sourceS3.getMetadata(),destinationObject);
        if (options.getAcl() != null)         keyToAcl.put(destinationBucket + "/" + destinationObject,options.getAcl());
        if (options.getMetadata() != null) {
          newMd.setUserMetadata(options.getMetadata());
        }
        newMd.setLastModified(new DateTime());
        dest.put(destinationObject,new S3Object(newMd,sourceS3.getData()));
        return copy(newMd);
      }
      throw new KeyNotFoundException(sourceBucket,sourceObject);
    }
  }
;
}
