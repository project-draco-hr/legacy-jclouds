{
  JsonObject rule=json.getAsJsonObject();
  Rule.Builder builder=Rule.builder();
  builder.IPProtocol(Rule.IPProtocol.fromValue(rule.get("IPProtocol").getAsString()));
  if (rule.get("ports") != null) {
    JsonArray ports=(JsonArray)rule.get("ports");
    for (    JsonElement port : ports) {
      String portAsString=port.getAsString();
      if (portAsString.contains("-")) {
        String[] split=portAsString.split("-");
        builder.addPortRange(Integer.parseInt(split[0]),Integer.parseInt(split[1]));
      }
 else {
        builder.addPort(Integer.parseInt(portAsString));
      }
    }
  }
  return builder.build();
}
