{
  byte[] buffer=this.buffer;
  Decoder decoder=this.decoder;
  int pos=this.pos;
  int limit=off + len;
  int ipos=off;
  while (ipos < limit) {
    pos=decoder.decode(b,ipos,limit,buffer,pos,buffer.length);
    int last=decoder.getLastInputPosition();
    if (last == ipos || pos >= buffer.length) {
      output.write(buffer,0,pos);
      pos=0;
    }
    ipos=last;
  }
  this.pos=pos;
}
