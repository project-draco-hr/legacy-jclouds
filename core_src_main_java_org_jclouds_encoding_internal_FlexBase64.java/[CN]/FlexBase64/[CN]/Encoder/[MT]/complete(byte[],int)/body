{
  if (state > 0) {
    target[pos++]=ENCODING_TABLE[last];
    for (int i=state; i < 3; i++) {
      target[pos++]=(byte)'=';
    }
    last=state=0;
  }
  if (wrap) {
    target[pos++]=0x0D;
    target[pos++]=0x0A;
  }
  return pos;
}
