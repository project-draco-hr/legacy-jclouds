{
  computeService.destroyNodesMatching(inGroup(group));
  SortedSet<NodeMetadata> nodes=newTreeSet(computeService.createNodesInGroup(group,2,getDefaultTemplateBuilder().build()));
  awaitForPublicAddressAssigned(nodes.iterator().next().getId());
  assertEquals(nodes.size(),2);
  checkNodes(nodes,group);
  NodeMetadata node1=nodes.first();
  NodeMetadata node2=nodes.last();
  assertLocationSameOrChild(node1.getLocation(),getDefaultTemplateBuilder().build().getLocation());
  assertLocationSameOrChild(node2.getLocation(),getDefaultTemplateBuilder().build().getLocation());
  checkImageIdMatchesTemplate(node1);
  checkImageIdMatchesTemplate(node2);
}
