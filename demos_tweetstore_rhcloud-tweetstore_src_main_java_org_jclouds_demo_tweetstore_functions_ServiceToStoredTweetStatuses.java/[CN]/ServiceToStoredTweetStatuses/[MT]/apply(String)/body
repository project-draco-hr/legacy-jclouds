{
  BlobStoreContext context=contexts.get(service);
  String host=URI.create(context.unwrap(Context.class).getProviderMetadata().getEndpoint()).getHost();
  try {
    BlobMap blobMap=context.createBlobMap(container);
    Set<String> blobs=blobMap.keySet();
    return Iterables.transform(blobs,new KeyToStoredTweetStatus(blobMap,service,host,container));
  }
 catch (  Exception e) {
    StoredTweetStatus result=new StoredTweetStatus(service,host,container,null,null,null,e.getMessage());
    logger.error(e,"Error listing service %s",service);
    return ImmutableList.of(result);
  }
}
