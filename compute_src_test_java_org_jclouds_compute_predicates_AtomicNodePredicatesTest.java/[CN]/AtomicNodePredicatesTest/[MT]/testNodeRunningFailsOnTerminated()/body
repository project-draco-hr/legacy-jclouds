{
  expect(node.getState()).andReturn(NodeState.TERMINATED).atLeastOnce();
  replay(node);
  replay(computeService);
  AtomicNodeRunning nodeRunning=new AtomicNodeRunning(computeService);
  AtomicReference<NodeMetadata> reference=new AtomicReference<NodeMetadata>(node);
  nodeRunning.apply(reference);
  Assert.assertEquals(reference.get(),node);
}
