{
  IVirtualBox vBox=manager.getVBox();
  try {
    final IMedium medium=vBox.findMedium(path,DeviceType.HardDisk);
    if (overwriteIfExists) {
      final IProgress progress=medium.deleteStorage();
      progress.waitForCompletion(-1);
      return createNewMedium(vBox,path);
    }
 else {
      throw new IllegalStateException("Medium for path " + path + " already exists.");
    }
  }
 catch (  VBoxException e) {
    if (notFoundException(e))     return createNewMedium(vBox,path);
    throw e;
  }
}
