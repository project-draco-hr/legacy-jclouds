{
  Matcher matcher=ALL_BEFORE_HYPHEN_HEX.matcher(from.getName());
  final String tag=matcher.find() ? matcher.group(1) : null;
  Set<String> ipSet=ImmutableSet.of(from.getIp().getIp());
  NodeState state=serverStateToNodeState.get(from.getState().getName());
  Credentials creds=client.getServerServices().getServerCredentialsList().get(from.getName());
  Image image=null;
  try {
    image=Iterables.find(images,new FindImageForServer(location,from));
  }
 catch (  NoSuchElementException e) {
    logger.warn("could not find a matching image for server %s in location %s",from,location);
  }
  return new NodeMetadataImpl(from.getId() + "",from.getName(),from.getId() + "",location,null,ImmutableMap.<String,String>of(),tag,image,state,ipSet,ImmutableList.<String>of(),ImmutableMap.<String,String>of(),creds);
}
