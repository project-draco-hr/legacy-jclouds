{
  String tag=parseTagFromName(from.getName());
  Set<String> ipSet=ImmutableSet.of(from.getIp().getIp());
  NodeState state=serverStateToNodeState.get(from.getState());
  Credentials creds=client.getServerServices().getServerCredentialsList().get(from.getName());
  Image image=null;
  try {
    image=Iterables.find(images.get(),new FindImageForServer(from));
  }
 catch (  NoSuchElementException e) {
    logger.warn("could not find a matching image for server %s",from);
  }
  Hardware hardware=null;
  try {
    hardware=Iterables.find(hardwares.get(),new FindHardwareForServer(from));
  }
 catch (  NoSuchElementException e) {
    logger.warn("could not find a matching hardware for server %s",from);
  }
  return new NodeMetadataImpl(from.getId() + "",from.getName(),from.getId() + "",locations.get().get(from.getDatacenter().getId() + ""),null,ImmutableMap.<String,String>of(),tag,hardware,from.getImage().getId() + "",image != null ? image.getOperatingSystem() : null,state,ipSet,ImmutableList.<String>of(),creds);
}
