{
  long retryMaxWait=TimeUnit.DAYS.toMillis(365);
  long retryPeriod=500;
  long retryMaxPeriod=5000;
  this.commandRunner=checkNotNull(commandRunner,"commandRunner");
  this.userThreads=checkNotNull(userThreads,"userThreads");
  this.notRunningAnymore=new RetryablePredicate<String>(new Predicate<String>(){
    @Override public boolean apply(    String arg0){
      return commandRunner.runAction(arg0).getOutput().trim().equals("");
    }
  }
,retryMaxWait,retryPeriod,retryMaxPeriod,TimeUnit.MILLISECONDS){
    /** 
 * make sure we stop the retry loop if someone cancelled the future, this keeps threads
 * from being consumed on dead tasks
 */
    @Override protected boolean atOrAfter(    Date end){
      if (shouldCancel)       Throwables.propagate(new TimeoutException("cancelled"));
      return super.atOrAfter(end);
    }
  }
;
}
