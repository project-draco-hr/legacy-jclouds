{
  HttpRequest get=HttpRequest.builder().method("PUT").endpoint("https://glance.jclouds.org:9292/v1.0/images/fcc451d0-f6e4-4824-ad8f-70ec12326d07").headers(ImmutableMultimap.<String,String>builder().put("Accept",MediaType.APPLICATION_JSON).put("X-Image-Meta-Name","newname").put("X-Image-Meta-Is_public","true").put("X-Image-Meta-Protected","true").put("X-Image-Meta-Checksum","XXXX").put("X-Image-Meta-Location","somewhere").put("X-Image-Meta-Min_disk","10").put("X-Image-Meta-Min_ram","2048").put("X-Auth-Token",authToken).build()).build();
  HttpResponse updateResponse=HttpResponse.builder().statusCode(200).payload(payloadFromResource("/image.json")).build();
  GlanceApi apiWhenExist=requestsSendResponses(keystoneAuthWithUsernameAndPassword,responseWithKeystoneAccess,get,updateResponse);
  assertEquals(apiWhenExist.getConfiguredRegions(),ImmutableSet.of("az-1.region-a.geo-1"));
  assertEquals(apiWhenExist.getImageApiForRegion("az-1.region-a.geo-1").update("fcc451d0-f6e4-4824-ad8f-70ec12326d07",UpdateImageOptions.Builder.name("newname"),UpdateImageOptions.Builder.isPublic(true),UpdateImageOptions.Builder.isProtected(true),UpdateImageOptions.Builder.checksum("XXXX"),UpdateImageOptions.Builder.location("somewhere"),UpdateImageOptions.Builder.minDisk(10),UpdateImageOptions.Builder.minRam(2048)),new ParseImageDetailsTest().expected());
}
