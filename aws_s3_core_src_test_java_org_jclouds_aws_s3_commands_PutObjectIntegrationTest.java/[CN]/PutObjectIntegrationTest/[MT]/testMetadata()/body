{
  String bucketName=bucketPrefix + "tmd";
  createBucketAndEnsureEmpty(bucketName);
  String key="hello";
  S3Object object=new S3Object(key,TEST_STRING);
  object.getMetadata().setCacheControl("no-cache");
  object.getMetadata().setContentType("text/plain");
  object.getMetadata().setContentEncoding("x-compress");
  object.getMetadata().setSize(TEST_STRING.length());
  object.getMetadata().setContentDisposition("attachment; filename=hello.txt");
  object.getMetadata().getUserMetadata().put(S3Headers.USER_METADATA_PREFIX + "adrian","powderpuff");
  object.getMetadata().setMd5(S3Utils.md5(TEST_STRING.getBytes()));
  addObjectToBucket(bucketName,object);
  S3Object newObject=validateContent(bucketName,key);
  assertEquals(newObject.getMetadata().getContentType(),"text/plain");
  assertEquals(newObject.getMetadata().getContentEncoding(),"x-compress");
  assertEquals(newObject.getMetadata().getContentDisposition(),"attachment; filename=hello.txt");
  assertEquals(newObject.getMetadata().getCacheControl(),"no-cache");
  assertEquals(newObject.getMetadata().getSize(),TEST_STRING.length());
  assertEquals(newObject.getMetadata().getUserMetadata().values().iterator().next(),"powderpuff");
  assertEquals(newObject.getMetadata().getMd5(),S3Utils.md5(TEST_STRING.getBytes()));
}
