{
  return createClient(new Function<HttpRequest,HttpResponse>(){
    ImmutableBiMap<HttpRequest,HttpResponse> bimap=ImmutableBiMap.copyOf(requestToResponse);
    @Override public HttpResponse apply(    HttpRequest input){
      if (!(requestToResponse.containsKey(input)))       return HttpResponse.builder().statusCode(500).message("no response configured for request").payload(Payloads.newStringPayload(renderRequest(input))).build();
      HttpResponse response=requestToResponse.get(input);
      assertEquals(renderRequest(input),renderRequest(bimap.inverse().get(response)));
      return response;
    }
  }
,module);
}
