{
  final GetOptions options=(nullableOptions == null) ? new GetOptions() : nullableOptions;
  return new FutureBase<B>(){
    public B get() throws InterruptedException, ExecutionException {
      if (!getContainerToBlobs().containsKey(bucketName))       throw new ContainerNotFoundException(bucketName);
      Map<String,B> realContents=getContainerToBlobs().get(bucketName);
      if (!realContents.containsKey(key))       throw new KeyNotFoundException(bucketName,key);
      B object=realContents.get(key);
      if (options.getIfMatch() != null) {
        if (!Arrays.equals(object.getMetadata().getETag(),HttpUtils.fromHexString(options.getIfMatch().replaceAll("\"",""))))         throwResponseException(412);
      }
      if (options.getIfNoneMatch() != null) {
        if (Arrays.equals(object.getMetadata().getETag(),HttpUtils.fromHexString(options.getIfNoneMatch().replaceAll("\"",""))))         throwResponseException(304);
      }
      if (options.getIfModifiedSince() != null) {
        DateTime modifiedSince=dateService.rfc822DateParse(options.getIfModifiedSince());
        if (object.getMetadata().getLastModified().isBefore(modifiedSince))         throw new ExecutionException(new RuntimeException(String.format("%1$s is before %2$s",object.getMetadata().getLastModified(),modifiedSince)));
      }
      if (options.getIfUnmodifiedSince() != null) {
        DateTime unmodifiedSince=dateService.rfc822DateParse(options.getIfUnmodifiedSince());
        if (object.getMetadata().getLastModified().isAfter(unmodifiedSince))         throw new ExecutionException(new RuntimeException(String.format("%1$s is after %2$s",object.getMetadata().getLastModified(),unmodifiedSince)));
      }
      B returnVal=createBlob(copy(object.getMetadata()),object.getData());
      if (options.getRange() != null) {
        byte[] data=(byte[])returnVal.getData();
        ByteArrayOutputStream out=new ByteArrayOutputStream();
        for (        String s : options.getRange().replaceAll("bytes=","").split(",")) {
          if (s.startsWith("-")) {
            int length=Integer.parseInt(s.replaceAll("\\-",""));
            out.write(data,data.length - length,length);
          }
 else           if (s.endsWith("-")) {
            int offset=Integer.parseInt(s.replaceAll("\\-",""));
            out.write(data,offset,data.length - offset);
          }
 else           if (s.contains("-")) {
            String[] firstLast=s.split("\\-");
            int offset=Integer.parseInt(firstLast[0]);
            int last=Integer.parseInt(firstLast[1]);
            int length=(last < data.length) ? last + 1 : data.length - offset;
            out.write(data,offset,length);
          }
 else {
            throw new IllegalArgumentException("first and last were null!");
          }
        }
        returnVal.setData(out.toByteArray());
        returnVal.setContentLength(out.size());
        returnVal.getMetadata().setSize(data.length);
      }
      returnVal.setData(new ByteArrayInputStream((byte[])returnVal.getData()));
      return returnVal;
    }
  }
;
}
