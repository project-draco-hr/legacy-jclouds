{
  if (apiOption.isPresent()) {
    FlavorExtraSpecsApi api=apiOption.get();
    for (    String key : testSpecs.keySet()) {
      assertTrue(api.setExtraSpec(testFlavor.getId(),key,"new value"));
    }
    for (    String key : testSpecs.keySet()) {
      assertEquals(api.getExtraSpec(testFlavor.getId(),key),"new value");
    }
    for (    Resource flavor : flavorApi.listFlavors()) {
      Map<String,String> specs=api.getAllExtraSpecs(flavor.getId());
      assertNotNull(specs);
      for (      Map.Entry<String,String> entry : specs.entrySet()) {
        assertEquals(api.getExtraSpec(flavor.getId(),entry.getKey()),entry.getValue());
      }
    }
  }
}
