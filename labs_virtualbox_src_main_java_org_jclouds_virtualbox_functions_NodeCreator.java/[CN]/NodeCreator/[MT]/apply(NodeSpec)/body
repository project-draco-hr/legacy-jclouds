{
  checkNotNull(nodeSpec,"NodeSpec");
  Master master=checkNotNull(nodeSpec.getMaster(),"Master");
  IMachine masterMachine=master.getMachine();
  String guestOsUser=masterMachine.getExtraData(GUEST_OS_USER);
  String guestOsPassword=masterMachine.getExtraData(GUEST_OS_PASSWORD);
  cleanUpMaster(master);
  CloneSpec cloneSpec=configureCloneSpec(nodeSpec,guestOsUser,guestOsPassword);
  IMachine clone=cloner.apply(cloneSpec);
  String cloneName=cloneSpec.getVmSpec().getVmName();
  logger.debug("<< cloned a vm(%s) from master(%s)",cloneName,nodeSpec.getMaster().getMachine().getName());
  machineController.ensureMachineIsLaunched(cloneName);
  logger.debug("<< cloned vm(%s) is up and running",cloneName);
  reconfigureNetworkInterfaces(masterMachine,guestOsUser,guestOsPassword,cloneSpec.getNetworkSpec(),clone);
  postConfigurations(clone,guestOsUser,guestOsPassword);
  LoginCredentials credentials=LoginCredentials.builder().user(guestOsUser).password(guestOsPassword).authenticateSudo(true).build();
  return new NodeAndInitialCredentials<IMachine>(clone,cloneName,credentials);
}
