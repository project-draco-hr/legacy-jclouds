{
  machineUtils.sharedLockMachineAndApplyToSession(vmName,new Function<ISession,Void>(){
    @Override public Void apply(    ISession session){
      String scriptName=scriptFile.getName();
      manager.get().getSessionObject().getConsole().getGuest().createSession(username,password,null,null).copyTo(scriptFile.getAbsolutePath(),"/tmp/" + scriptName,null);
      manager.get().getSessionObject().getConsole().getGuest().createSession(username,password,null,null).processCreate("/bin/chmod",ImmutableList.of("777","/tmp/" + scriptName),null,null,5 * 1000l);
      manager.get().getSessionObject().getConsole().getGuest().createSession(username,password,null,null).processCreate("/bin/sh",ImmutableList.of("/tmp/" + scriptName),null,null,5 * 1000l);
      return null;
    }
  }
);
}
