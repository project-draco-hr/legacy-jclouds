{
  doAttach();
  if (metadata == null)   throw new FileNotFolderException(getName());
  ListContainerOptions options=new ListContainerOptions();
  String name=getNameTrimLeadingSlashes();
  if (!name.equals("") && !name.equals("/")) {
    options.inDirectory(name + "/");
    logger.info(String.format(">> list: %s[%s]",getContainer(),name));
  }
 else {
    logger.info(String.format(">> list: %s",getContainer()));
  }
  ListContainerResponse<? extends ResourceMetadata> list=getBlobStore().list(getContainer(),options);
  Set<BlobStoreFileObject> children=Sets.newHashSet();
  loop:   for (  ResourceMetadata md : list) {
    if (!md.getName().equals("")) {
      if (name.equals(md.getName()) && md.getType() != ResourceType.BLOB) {
        continue loop;
      }
      if (isDirectoryStrategy.execute(md)) {
        md=resource2Directory.apply(md);
      }
      String childName=md.getName().replaceAll("[^/]*//*","");
      BlobStoreFileObject fo=(BlobStoreFileObject)FileObjectUtils.getAbstractFileObject(getFileSystem().resolveFile(getFileSystem().getFileSystemManager().resolveName(getName(),childName,NameScope.CHILD)));
      children.add(fo);
    }
  }
  logger.info(String.format("<< list: %s",children));
  return children.toArray(new BlobStoreFileObject[]{});
}
