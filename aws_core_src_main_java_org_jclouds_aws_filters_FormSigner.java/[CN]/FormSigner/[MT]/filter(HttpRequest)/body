{
  checkNotNull(request.getFirstHeaderOrNull(HttpHeaders.HOST),"request is not ready to sign; host not present");
  Multimap<String,String> decodedParams=parseQueryToMap(request.getPayload().getRawContent().toString());
  addSigningParams(decodedParams);
  validateParams(decodedParams);
  String stringToSign=createStringToSign(request,decodedParams);
  String signature=sign(stringToSign);
  addSignature(decodedParams,signature);
  setPayload(request,decodedParams);
  utils.logRequest(signatureLog,request,"<<");
}
