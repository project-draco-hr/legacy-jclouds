{
  GeneratedHttpRequest<?> request=(GeneratedHttpRequest<?>)in;
  checkNotNull(request.getFirstHeaderOrNull(HttpHeaders.HOST),"request is not ready to sign; host not present");
  Multimap<String,String> decodedParams=RestAnnotationProcessor.parseQueryToMap(request.getPayload().getRawContent().toString());
  request.getHeaders().removeAll(HttpHeaders.CONTENT_LENGTH);
  addSigningParams(decodedParams);
  validateParams(decodedParams);
  String stringToSign=createStringToSign(request,decodedParams);
  String signature=sign(stringToSign);
  addSignature(decodedParams,signature);
  setPayload(request,decodedParams);
  HttpUtils.logRequest(signatureLog,request,"<<");
}
