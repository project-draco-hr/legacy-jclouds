{
  RestContext<AbiquoApi,AbiquoAsyncApi> context=EasyMock.createMock(RestContext.class);
  VirtualMachineTemplateToImage function=new VirtualMachineTemplateToImage();
  VirtualMachineTemplateDto dto=new VirtualMachineTemplateDto();
  dto.setId(5);
  dto.setName("Template");
  dto.setDescription("Template description");
  dto.addLink(new RESTLink("diskfile","http://foo/bar"));
  Image image=function.apply(wrap(context,VirtualMachineTemplate.class,dto));
  assertEquals(image.getId(),dto.getId().toString());
  assertEquals(image.getName(),dto.getName());
  assertEquals(image.getDescription(),dto.getDescription());
  assertEquals(image.getUri(),URI.create("http://foo/bar"));
  assertEquals(image.getOperatingSystem(),OperatingSystem.builder().description(dto.getName()).build());
}
