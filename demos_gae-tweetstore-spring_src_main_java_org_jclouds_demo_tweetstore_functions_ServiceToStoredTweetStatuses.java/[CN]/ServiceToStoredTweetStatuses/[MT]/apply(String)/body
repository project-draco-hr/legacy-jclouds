{
  BlobStoreContext context=contexts.get(service);
  String host=context.getProviderSpecificContext().getEndpoint().getHost();
  try {
    BlobMap blobMap=context.createBlobMap(container);
    Set<String> blobs=blobMap.keySet();
    return Iterables.transform(blobs,new KeyToStoredTweetStatus(blobMap,service,host,container));
  }
 catch (  Exception e) {
    StoredTweetStatus result=new StoredTweetStatus(service,host,container,null,null,null,e.getMessage());
    logger.error(e,"Error listing service %s",service);
    return Collections.singletonList(result);
  }
}
