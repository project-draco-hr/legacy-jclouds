{
  Iterable<ObjectMetadata> contents=Iterables.transform(Iterables.filter(list,new Predicate<ResourceMetadata>(){
    public boolean apply(    ResourceMetadata input){
      return input.getType() == ResourceType.BLOB;
    }
  }
),new Function<ResourceMetadata,ObjectMetadata>(){
    public MutableObjectMetadata apply(    ResourceMetadata from){
      return blob2ObjectMd.apply((BlobMetadata)from);
    }
  }
);
  SortedSet<String> commonPrefixes=Sets.newTreeSet(Iterables.transform(Iterables.filter(list,new Predicate<ResourceMetadata>(){
    public boolean apply(    ResourceMetadata input){
      return input.getType() == ResourceType.RELATIVE_PATH;
    }
  }
),new Function<ResourceMetadata,String>(){
    public String apply(    ResourceMetadata from){
      return from.getName();
    }
  }
));
  return new TreeSetListBucketResponse(null,contents,list.getPath(),list.getMarker(),list.getMaxResults(),"/",Iterables.size(contents) == list.getMaxResults(),commonPrefixes);
}
