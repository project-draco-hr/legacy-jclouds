{
  logger.trace("attempting to create client %s",id);
  Client client=validatorClient.getContext().getApi().createClient(id);
  logger.debug("created client %s",id);
  ChefService clientService=null;
  try {
    Properties clientProperties=new Properties();
    clientProperties.putAll(overrides);
    removeCredentials(clientProperties);
    clientProperties.setProperty("chef.identity",id);
    clientProperties.setProperty("chef.credential",validatorClient.getContext().utils().encryption().toPem(client.getPrivateKey()));
    clientService=createService(clientProperties);
    clientService.createNodeAndPopulateAutomaticAttributes(id,singleton("role[" + role + "]"));
    return clientService;
  }
 catch (  RuntimeException e) {
    logger.error(e,"error creating node %s",id);
    throw e;
  }
}
