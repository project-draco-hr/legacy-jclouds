{
  String content;
  try {
    content=response.getContent() != null ? Utils.toStringAndClose(response.getContent()) : null;
    if (content != null) {
      try {
        if (content.indexOf('<') >= 0) {
          AtmosStorageError error=utils.parseAtmosStorageErrorFromContent(command,response,content);
          AtmosStorageResponseException exception=new AtmosStorageResponseException(command,response,error);
          if (error.getCode() == 1016) {
            File file=new File(command.getRequest().getEndpoint().getPath());
            command.setException(new KeyAlreadyExistsException(file.getParentFile().getAbsolutePath(),file.getName(),exception));
          }
 else {
            command.setException(exception);
          }
        }
 else {
          command.setException(new HttpResponseException(command,response,content));
        }
      }
 catch (      Exception he) {
        command.setException(new HttpResponseException(command,response,content));
        Throwables.propagateIfPossible(he);
      }
    }
 else {
      command.setException(new HttpResponseException(command,response));
    }
  }
 catch (  Exception e) {
    command.setException(new HttpResponseException(command,response));
    Throwables.propagateIfPossible(e);
  }
}
