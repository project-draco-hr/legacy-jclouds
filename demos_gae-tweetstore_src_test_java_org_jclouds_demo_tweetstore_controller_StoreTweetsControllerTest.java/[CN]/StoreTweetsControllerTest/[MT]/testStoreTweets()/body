{
  Set<BlobMap> maps=createMaps();
  StoreTweetsController function=new StoreTweetsController(maps,createTwitterClient());
  SortedSet<Status> allAboutMe=Sets.newTreeSet();
  User frank=new User();
  frank.setScreenName("frank");
  Status frankStatus=new Status();
  frankStatus.setId(1);
  frankStatus.setUser(frank);
  frankStatus.setText("I love beans!");
  User jimmy=new User();
  jimmy.setScreenName("jimmy");
  Status jimmyStatus=new Status();
  jimmyStatus.setId(2);
  jimmyStatus.setUser(jimmy);
  jimmyStatus.setText("cloud is king");
  allAboutMe.add(frankStatus);
  allAboutMe.add(jimmyStatus);
  function.addMyTweets(allAboutMe);
  for (  BlobMap map : maps) {
    Blob frankBlob=map.get("1");
    assertEquals(frankBlob.getMetadata().getName(),"1");
    assertEquals(frankBlob.getMetadata().getUserMetadata().get(TweetStoreConstants.SENDER_NAME),"frank");
    assertEquals(frankBlob.getMetadata().getContentType(),"text/plain");
    assertEquals(IOUtils.toString((InputStream)frankBlob.getData()),"I love beans!");
    Blob jimmyBlob=map.get("2");
    assertEquals(jimmyBlob.getMetadata().getName(),"2");
    assertEquals(jimmyBlob.getMetadata().getUserMetadata().get(TweetStoreConstants.SENDER_NAME),"jimmy");
    assertEquals(jimmyBlob.getMetadata().getContentType(),"text/plain");
    assertEquals(IOUtils.toString((InputStream)jimmyBlob.getData()),"cloud is king");
  }
}
