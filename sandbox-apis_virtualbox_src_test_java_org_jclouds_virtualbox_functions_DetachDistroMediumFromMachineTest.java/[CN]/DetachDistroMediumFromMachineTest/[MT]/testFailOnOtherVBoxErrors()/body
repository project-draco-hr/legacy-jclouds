{
  String controllerName="IDE Controller";
  IMachine machine=createNiceMock(IMachine.class);
  final StringBuilder errorBuilder=new StringBuilder();
  errorBuilder.append("VirtualBox error: ");
  errorBuilder.append("Some other VBox error");
  String isoAlreadyAttachedException=errorBuilder.toString();
  int controllerPort=0;
  int device=1;
  VBoxException isoAttachedException=new VBoxException(createNiceMock(Throwable.class),isoAlreadyAttachedException);
  machine.detachDevice(controllerName,controllerPort,device);
  expectLastCall().andThrow(isoAttachedException);
  replay(machine);
  new DetachDistroMediumFromMachine(controllerName,controllerPort,device).apply(machine);
}
