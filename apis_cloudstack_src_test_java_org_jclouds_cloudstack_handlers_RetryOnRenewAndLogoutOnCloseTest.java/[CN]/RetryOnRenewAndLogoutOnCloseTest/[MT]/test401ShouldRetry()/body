{
  HttpCommand command=createMock(HttpCommand.class);
  SessionClient sessionClient=createMock(SessionClient.class);
  LoadingCache<Credentials,LoginResponse> cache=createMock(LoadingCache.class);
  cache.invalidateAll();
  expectLastCall();
  replay(cache,command);
  HttpResponse response=HttpResponse.builder().payload(Payloads.newStringPayload("Not relevant")).statusCode(401).build();
  RetryOnRenewAndLogoutOnClose retry=new RetryOnRenewAndLogoutOnClose(cache,sessionClient);
  assertTrue(retry.shouldRetryRequest(command,response));
  verify(cache,command);
}
