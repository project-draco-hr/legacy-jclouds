{
  Blob<?> object=(Blob<?>)entity;
  for (  String key : object.getMetadata().getUserMetadata().keySet()) {
    request.getHeaders().putAll(key.startsWith(metadataPrefix) ? key : metadataPrefix + key,object.getMetadata().getUserMetadata().get(key));
  }
  request.setEntity(checkNotNull(object.getData(),"object.getContent()"));
  request.getHeaders().put(HttpHeaders.CONTENT_TYPE,checkNotNull(object.getMetadata().getContentType(),"object.metadata.contentType()"));
  request.getHeaders().put(HttpHeaders.CONTENT_LENGTH,object.getMetadata().getSize() + "");
  if (object.getMetadata().getContentMD5() != null) {
    request.getHeaders().put("Content-MD5",HttpUtils.toBase64String(object.getMetadata().getContentMD5()));
  }
  return request;
}
