{
  String bucketName=getBucketName();
  try {
    BaseS3Map<S3Object> map=createMap(context,bucketName);
    S3Object object=new S3Object("one");
    object.setData(IOUtils.toInputStream("apple"));
    object.generateETag();
    S3Object old=map.put(object.getKey(),object);
    getOneReturnsAppleAndOldValueIsNull(map,old);
    object.setData(IOUtils.toInputStream("bear"));
    object.generateETag();
    S3Object apple=map.put(object.getKey(),object);
    getOneReturnsBearAndOldValueIsApple(map,apple);
  }
  finally {
    returnBucket(bucketName);
  }
}
