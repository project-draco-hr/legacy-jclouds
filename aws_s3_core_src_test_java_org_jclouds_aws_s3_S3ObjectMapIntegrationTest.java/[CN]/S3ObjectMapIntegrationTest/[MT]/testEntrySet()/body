{
  String bucketName=getBucketName();
  try {
    BaseS3Map<S3Object> map=createMap(context,bucketName);
    putFiveStrings(map);
    Set<Entry<String,S3Object>> entries=map.entrySet();
    assertEquals(entries.size(),5);
    for (    Entry<String,S3Object> entry : entries) {
      assertEquals(S3Utils.getContentAsStringAndClose(entry.getValue()),fiveStrings.get(entry.getKey()));
      S3Object value=entry.getValue();
      value.setData("");
      value.generateMd5();
      entry.setValue(value);
    }
    assertEventuallyMapSize(map,5);
    for (    S3Object value : map.values()) {
      assertEquals(S3Utils.getContentAsStringAndClose(value),"");
    }
  }
  finally {
    returnBucket(bucketName);
  }
}
