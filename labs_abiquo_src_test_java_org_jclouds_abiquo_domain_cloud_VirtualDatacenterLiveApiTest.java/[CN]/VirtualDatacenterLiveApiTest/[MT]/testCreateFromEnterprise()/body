{
  Enterprise enterprise=env.enterpriseAdminContext.getAdministrationService().getCurrentUser().getEnterprise();
  assertNotNull(enterprise);
  List<Datacenter> datacenters=enterprise.listAllowedDatacenters();
  assertNotNull(datacenters);
  assertTrue(size(datacenters) > 0);
  Datacenter datacenter=datacenters.get(0);
  List<HypervisorType> hypervisors=datacenter.listAvailableHypervisors();
  assertNotNull(datacenters);
  assertTrue(size(datacenters) > 0);
  HypervisorType hypervisor=hypervisors.get(0);
  PrivateNetwork network=PrivateNetwork.builder(env.enterpriseAdminContext.getApiContext()).name("DefaultNetwork").gateway("192.168.1.1").address("192.168.1.0").mask(24).build();
  VirtualDatacenter virtualDatacenter=VirtualDatacenter.builder(env.enterpriseAdminContext.getApiContext(),datacenters.get(0),enterprise).name(PREFIX + "Plain Virtual Aloha from ENT").cpuCountLimits(18,20).hdLimitsInMb(279172872,279172872).publicIpsLimits(2,2).ramLimits(19456,20480).storageLimits(289910292,322122547).vlansLimits(1,2).hypervisorType(hypervisor).network(network).build();
  virtualDatacenter.save();
  assertNotNull(virtualDatacenter.getId());
  virtualDatacenter.delete();
}
