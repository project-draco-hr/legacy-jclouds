{
  if (clientOption.isPresent() && hostAdminOption.isPresent()) {
    HostAggregateClient client=clientOption.get();
    Host host=Iterables.getFirst(hostAdminOption.get().listHosts(),null);
    assertNotNull(host);
    String host_id=host.getName();
    assertNotNull(host_id);
    HostAggregate details;
    try {
      details=client.addHost(testAggregate.getId(),host_id);
      assertEquals(details.getHosts(),ImmutableSet.of(host_id));
      details=client.getAggregate(testAggregate.getId());
      assertEquals(details.getHosts(),ImmutableSet.of(host_id));
    }
  finally {
      details=client.removeHost(testAggregate.getId(),host_id);
    }
    assertEquals(details.getHosts(),ImmutableSet.of());
  }
}
