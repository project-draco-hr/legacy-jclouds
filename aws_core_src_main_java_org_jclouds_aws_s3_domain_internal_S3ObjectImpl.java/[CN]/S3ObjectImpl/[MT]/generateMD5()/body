{
  checkState(data != null,"data");
  if (data instanceof InputStream) {
    MD5InputStreamResult result=generateMD5Result.apply((InputStream)data);
    getMetadata().setContentMD5(result.md5);
    setContentLength(result.length);
    setData(result.data);
  }
 else {
    getMetadata().setContentMD5(generateMD5.apply(data));
  }
}
