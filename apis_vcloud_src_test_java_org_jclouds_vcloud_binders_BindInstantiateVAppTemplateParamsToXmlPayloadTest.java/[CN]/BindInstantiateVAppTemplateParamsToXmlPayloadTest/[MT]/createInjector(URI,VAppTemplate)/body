{
  final VCloudClient client=createMock(VCloudClient.class);
  final VAppTemplateClient tclient=createMock(VAppTemplateClient.class);
  expect(client.getVAppTemplateClient()).andReturn(tclient).anyTimes();
  expect(tclient.getVAppTemplate(vAppTemplate)).andReturn(value).anyTimes();
  replay(client);
  replay(tclient);
  return Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties props=new Properties();
      Names.bindProperties(binder(),checkNotNull(new VCloudPropertiesBuilder(props).build(),"properties"));
      bind(VCloudClient.class).toInstance(client);
    }
    @SuppressWarnings("unused") @Network @Provides @Singleton ReferenceType provideNetwork(){
      return new ReferenceTypeImpl(null,null,URI.create("https://vcenterprise.bluelock.com/api/v1.0/network/1990"));
    }
  }
);
}
