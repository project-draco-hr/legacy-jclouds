{
  if (apiOption.isPresent()) {
    HostAggregateApi api=apiOption.get();
    for (    Map<String,String> theMetaData : ImmutableSet.of(ImmutableMap.of("somekey","somevalue"),ImmutableMap.of("somekey","some other value","anotherkey","another val"))) {
      HostAggregate details=api.setMetadata(testAggregate.getId(),theMetaData);
      for (      String key : theMetaData.keySet()) {
        assertEquals(details.getMetadata().get(key),theMetaData.get(key));
      }
      details=api.get(testAggregate.getId());
      for (      String key : theMetaData.keySet()) {
        assertEquals(details.getMetadata().get(key),theMetaData.get(key));
      }
    }
  }
}
