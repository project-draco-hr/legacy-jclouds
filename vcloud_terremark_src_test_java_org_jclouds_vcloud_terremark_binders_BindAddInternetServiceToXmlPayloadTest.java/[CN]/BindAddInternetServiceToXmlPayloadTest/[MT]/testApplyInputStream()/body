{
  String expected=Utils.toStringAndClose(getClass().getResourceAsStream("/terremark/CreateInternetService-test.xml"));
  HttpRequest request=new HttpRequest("GET",URI.create("http://test"));
  BindAddInternetServiceToXmlPayload binder=injector.getInstance(BindAddInternetServiceToXmlPayload.class);
  Map<String,String> map=Maps.newHashMap();
  map.put("name","name");
  map.put("protocol","TCP");
  map.put("port","22");
  map.put("enabled","true");
  map.put("description","name TCP 22");
  binder.bindToRequest(request,map);
  assertEquals(request.getFirstHeaderOrNull(HttpHeaders.CONTENT_TYPE),"application/unknown");
  assertEquals(request.getFirstHeaderOrNull(HttpHeaders.CONTENT_LENGTH),"341");
  assertEquals(request.getPayload().getRawContent(),expected);
}
