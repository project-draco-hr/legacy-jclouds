{
  JAXBParser xmlParser=new JAXBParser("false");
  Function<Exception,VolumeManagementDto> function=new ReturnMovedVolume(new ReturnMoveVolumeReference(new JAXBParser("false"),TypeLiteral.get(MovedVolumeDto.class)));
  VolumeManagementDto volume=new VolumeManagementDto();
  volume.setName("Test volume");
  MovedVolumeDto movedRef=new MovedVolumeDto();
  movedRef.setVolume(volume);
  HttpResponse response=EasyMock.createMock(HttpResponse.class);
  HttpResponseException exception=EasyMock.createMock(HttpResponseException.class);
  Payload payload=Payloads.newPayload(xmlParser.toXML(movedRef));
  expect(response.getStatusCode()).andReturn(Status.MOVED_PERMANENTLY.getStatusCode());
  expect(exception.getResponse()).andReturn(response);
  expect(exception.getResponse()).andReturn(response);
  expect(response.getPayload()).andReturn(payload);
  expect(response.getPayload()).andReturn(payload);
  expect(response.getPayload()).andReturn(payload);
  expect(exception.getCause()).andReturn(null);
  replay(response);
  replay(exception);
  function.apply(exception);
  verify(response);
  verify(exception);
}
