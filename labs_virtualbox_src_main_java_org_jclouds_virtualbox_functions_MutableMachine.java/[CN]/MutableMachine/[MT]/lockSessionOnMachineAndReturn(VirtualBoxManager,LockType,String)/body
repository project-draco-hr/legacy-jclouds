{
  int retries=5;
  int count=0;
  while (true) {
    try {
      ISession session=manager.getSessionObject();
      IMachine immutableMachine=manager.getVBox().findMachine(machineId);
      immutableMachine.lockMachine(session,type);
      return session;
    }
 catch (    VBoxException e) {
      count++;
      logger.warn("Could not lock machine (try %i of %i). Error: %s",retries,count,e.getMessage());
      if (count == retries) {
        throw new RuntimeException(String.format("error locking %s with %s lock: %s",machineId,type,e.getMessage()),e);
      }
    }
  }
}
