{
  Map<String,String> query=ImmutableMap.of("moo",val);
  assertEquals(uriBuilder("https://foo.com:8080").query(query).toString(),"https://foo.com:8080?moo=" + val);
  assertEquals(uriBuilder("https://foo.com:8080").query(query).build().toString(),"https://foo.com:8080?moo=" + urlEncode(val,'/',','));
  assertEquals(uriBuilder("https://api.github.com/repos/user?foo=bar&kung=fu").query(query).toString(),"https://api.github.com/repos/user?moo=" + val);
  assertEquals(uriBuilder("https://api.github.com/repos/user?foo=bar&kung=fu").query(query).build().toString(),"https://api.github.com/repos/user?moo=" + urlEncode(val,'/',','));
  assertEquals(uriBuilder("https://api.github.com/repos/{user}").query(query).toString(),"https://api.github.com/repos/{user}?moo=" + val);
  assertEquals(uriBuilder("https://api.github.com/repos/{user}").query(query).build(templateParams).toASCIIString(),"https://api.github.com/repos/bob?moo=" + urlEncode(val,'/',','));
}
