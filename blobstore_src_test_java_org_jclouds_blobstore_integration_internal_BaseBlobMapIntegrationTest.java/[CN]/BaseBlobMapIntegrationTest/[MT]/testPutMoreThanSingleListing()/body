{
  if (maxResultsForTestListings() == 0)   return;
  String bucketName=getContainerName();
  try {
    Map<String,Blob> map=createMap(context,bucketName);
    Set<String> keySet=Sets.newHashSet();
    for (int i=0; i < maxResultsForTestListings() + 1; i++) {
      keySet.add(i + "");
    }
    Map<String,Blob> newMap=new HashMap<String,Blob>();
    for (    String key : keySet) {
      Blob object=context.getBlobStore().newBlob(key);
      object.setPayload(key);
      newMap.put(key,object);
    }
    map.putAll(newMap);
    newMap.clear();
    assertConsistencyAwareMapSize(map,maxResultsForTestListings() + 1);
    assertConsistencyAwareKeySetEquals(map,keySet);
    map.clear();
    assertConsistencyAwareMapSize(map,0);
  }
  finally {
    returnContainer(bucketName);
  }
}
