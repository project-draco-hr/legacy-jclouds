{
  HttpRequest listWithOptions=HttpRequest.builder().method("POST").endpoint(URI.create("https://iam.amazonaws.com/")).headers(ImmutableMultimap.<String,String>builder().put("Host","iam.amazonaws.com").build()).payload(payloadFromStringWithContentType("Action=ListUsers" + "&Marker=MARKER" + "&PathPrefix=%2Ffoo"+ "&Signature=1%2BeCgNIAjHr%2BraNdDd3rsVC5Qok3AuTrJOa5mZwmE7g%3D"+ "&SignatureMethod=HmacSHA256"+ "&SignatureVersion=2"+ "&Timestamp=2009-11-08T15%3A54%3A08.897Z"+ "&Version=2010-05-08"+ "&AWSAccessKeyId=identity","application/x-www-form-urlencoded")).build();
  HttpResponse listWithOptionsResponse=HttpResponse.builder().statusCode(200).payload(payloadFromResourceWithContentType("/list_users.xml","text/xml")).build();
  IAMClient clientWhenWithOptionsExist=requestSendsResponse(listWithOptions,listWithOptionsResponse);
  assertEquals(clientWhenWithOptionsExist.getUserClient().list(pathPrefix("/foo").afterMarker("MARKER")).toString(),new ListUsersResponseTest().expected().toString());
}
