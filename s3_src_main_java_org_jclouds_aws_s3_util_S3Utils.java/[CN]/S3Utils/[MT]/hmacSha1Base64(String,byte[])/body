{
  HMac hmac=new HMac(new SHA1Digest());
  byte[] resBuf=new byte[hmac.getMacSize()];
  byte[] plainBytes=toEncode.getBytes();
  byte[] keyBytes=key;
  hmac.init(new KeyParameter(keyBytes));
  hmac.update(plainBytes,0,plainBytes.length);
  hmac.doFinal(resBuf,0);
  return toBase64String(resBuf);
}
