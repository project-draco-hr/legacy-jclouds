{
  try {
    StorageController ideController=StorageController.builder().name(ideControllerName).bus(StorageBus.IDE).attachISO(0,0,operatingSystemIso).attachHardDisk(HardDisk.builder().diskpath(adminDisk).controllerPort(0).deviceSlot(1).build()).attachISO(1,1,guestAdditionsIso).build();
    VmSpec vmSpec=VmSpec.builder().id(vmId).name(vmName).osTypeId(osTypeId).memoryMB(512).cleanUpMode(CleanupMode.Full).controller(ideController).forceOverwrite(true).build();
    return new CreateAndRegisterMachineFromIsoIfNotAlreadyExists(manager).apply(vmSpec);
  }
 catch (  IllegalStateException e) {
    return manager.getVBox().findMachine(vmName);
  }
}
