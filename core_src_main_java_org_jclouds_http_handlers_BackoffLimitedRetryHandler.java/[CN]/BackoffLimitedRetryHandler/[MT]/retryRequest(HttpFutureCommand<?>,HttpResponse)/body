{
  IOUtils.closeQuietly(response.getContent());
  command.incrementFailureCount();
  if (!command.getRequest().isReplayable()) {
    logger.warn("Cannot retry after server error, command is not replayable: %1$s",command);
    return false;
  }
 else   if (command.getFailureCount() > retryCountLimit) {
    logger.warn("Cannot retry after server error, command has exceeded retry limit %1$d: %2$s",retryCountLimit,command);
    return false;
  }
 else {
    long delayMs=(long)(50L * Math.pow(command.getFailureCount(),2));
    logger.debug("Retry %1$d/%2$d after server error, delaying for %3$d ms: %4$s",command.getFailureCount(),retryCountLimit,delayMs,command);
    Thread.sleep(delayMs);
    return true;
  }
}
