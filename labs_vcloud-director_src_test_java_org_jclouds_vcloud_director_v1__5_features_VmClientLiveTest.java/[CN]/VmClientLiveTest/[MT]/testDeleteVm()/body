{
  VApp delete=instantiateVApp();
  DeployVAppParams params=DeployVAppParams.builder().deploymentLeaseSeconds((int)TimeUnit.SECONDS.convert(1L,TimeUnit.HOURS)).notForceCustomization().powerOn().build();
  Task deployVApp=vAppClient.deploy(delete.getHref(),params);
  assertTaskSucceedsLong(deployVApp);
  delete=vAppClient.getVApp(delete.getHref());
  Vm temp=Iterables.getOnlyElement(delete.getChildren().getVms());
  Task deleteVm=vmClient.deleteVm(temp.getHref());
  assertTrue(retryTaskSuccess.apply(deleteVm),String.format(TASK_COMPLETE_TIMELY,"deleteVm"));
  Vm deleted=vmClient.getVm(temp.getHref());
  assertNull(deleted,"The Vm " + temp.getName() + " should have been deleted");
}
