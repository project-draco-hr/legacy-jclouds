{
  for (  String zoneId : context.getApi().getConfiguredZones()) {
    Optional<FloatingIPClient> clientOption=context.getApi().getFloatingIPExtensionForZone(zoneId);
    if (!clientOption.isPresent())     continue;
    FloatingIPClient client=clientOption.get();
    FloatingIP floatingIP=client.allocate();
    assertNotNull(floatingIP);
    Set<FloatingIP> response=client.listFloatingIPs();
    boolean ipInSet=false;
    for (    FloatingIP ip : response) {
      if (ip.getId().equals(floatingIP.getId()))       ipInSet=true;
    }
    assertTrue(ipInSet);
    client.deallocate(floatingIP.getId());
    response=client.listFloatingIPs();
    ipInSet=false;
    for (    FloatingIP ip : response) {
      if (ip.getId().equals(floatingIP.getId())) {
        ipInSet=true;
      }
    }
    assertFalse(ipInSet);
  }
}
