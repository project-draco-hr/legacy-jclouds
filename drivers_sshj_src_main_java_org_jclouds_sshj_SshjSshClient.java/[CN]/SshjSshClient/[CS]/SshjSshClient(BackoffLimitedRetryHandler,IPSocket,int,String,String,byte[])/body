{
  this.host=checkNotNull(socket,"socket").getAddress();
  checkArgument(socket.getPort() > 0,"ssh port must be greater then zero" + socket.getPort());
  checkArgument(password != null || privateKey != null,"you must specify a password or a key");
  this.port=socket.getPort();
  this.username=checkNotNull(username,"username");
  this.backoffLimitedRetryHandler=checkNotNull(backoffLimitedRetryHandler,"backoffLimitedRetryHandler");
  this.timeoutMillis=timeout;
  this.password=password;
  this.privateKey=privateKey;
  if (privateKey == null) {
    this.toString=String.format("%s@%s:%d",username,host,port);
  }
 else {
    RSAPrivateCrtKeySpec key=(RSAPrivateCrtKeySpec)Pems.privateKeySpec(new String(privateKey));
    String fingerPrint=fingerprint(key.getPublicExponent(),key.getModulus());
    this.toString=String.format("%s:[%s]@%s:%d",username,fingerPrint,host,port);
  }
}
