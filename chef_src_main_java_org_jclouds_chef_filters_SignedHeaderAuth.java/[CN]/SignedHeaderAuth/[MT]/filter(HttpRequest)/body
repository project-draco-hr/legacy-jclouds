{
  String contentHash=hashBody(request.getPayload());
  request.getHeaders().replaceValues("X-Ops-Content-Hash",Collections.singletonList(contentHash));
  String timestamp=timeStampProvider.get();
  String toSign=createStringToSign(request.getMethod(),hashPath(request.getEndpoint().getPath()),contentHash,timestamp);
  request.getHeaders().replaceValues("X-Ops-Userid",Collections.singletonList(userId));
  request.getHeaders().replaceValues("X-Ops-Sign",Collections.singletonList(SIGNING_DESCRIPTION));
  calculateAndReplaceAuthorizationHeaders(request,toSign);
  request.getHeaders().replaceValues("X-Ops-Timestamp",Collections.singletonList(timestamp));
  utils.logRequest(signatureLog,request,"<<");
}
