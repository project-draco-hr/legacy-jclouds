{
  checkArgument(checkNotNull(request,"request") instanceof GeneratedHttpRequest,"this binder is only valid for GeneratedHttpRequests!");
  GeneratedHttpRequest gRequest=(GeneratedHttpRequest)request;
  checkState(gRequest.getArgs() != null,"args should be initialized at this point");
  String name=checkNotNull(postParams.remove("name"),"name");
  String template=checkNotNull(postParams.remove("template"),"template");
  String network=postParams.remove("network");
  String fenceMode=postParams.remove("fenceMode");
  String dhcpEnabled=postParams.remove("dhcpEnabled");
  String networkName=postParams.remove("networkName");
  SortedMap<ResourceType,String> virtualHardwareQuantity=extractVirtualQuantityFromPostParams(postParams);
  InstantiateVAppTemplateOptions options=findOptionsInArgsOrNull(gRequest);
  Map<String,String> properties=Maps.newTreeMap();
  if (options != null) {
    String networkFromOptions=addQuantityOrReturnNetwork(options,virtualHardwareQuantity,network);
    network=networkFromOptions != null ? networkFromOptions : network;
    properties.putAll(options.getProperties());
  }
  try {
    stringBinder.bindToRequest(request,generateXml(name,template,properties,virtualHardwareQuantity,networkName == null ? name : networkName,fenceMode == null ? defaultFenceMode : FenceMode.fromValue(fenceMode),dhcpEnabled == null ? defaultDhcpEnabled : Boolean.parseBoolean(dhcpEnabled),network == null ? defaultNetwork : URI.create(network)));
  }
 catch (  ParserConfigurationException e) {
    throw new RuntimeException(e);
  }
catch (  FactoryConfigurationError e) {
    throw new RuntimeException(e);
  }
catch (  TransformerException e) {
    throw new RuntimeException(e);
  }
}
