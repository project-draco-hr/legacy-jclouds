{
  try {
    XMLBuilder rootBuilder=buildRoot();
    XMLBuilder vAppChildrenBuilder=buildChildren(rootBuilder);
    for (    VMSpec spec : specs) {
      checkNotNull(spec,"VMSpec");
      checkNotNull(spec.getName(),"name");
      checkNotNull(spec.getNetwork(),"network");
      checkNotNull(spec.getNetwork().getName(),"networkName");
      XMLBuilder vAppBuilder=buildRootForName(vAppChildrenBuilder,spec.getName());
      addOperatingSystemSection(vAppBuilder,spec.getOperatingSystem());
      addVirtualHardwareSection(vAppBuilder,spec.getName(),spec.getNetwork().getName().replace("-"," "),spec);
    }
    Properties outputProperties=new Properties();
    outputProperties.put(javax.xml.transform.OutputKeys.OMIT_XML_DECLARATION,"yes");
    return rootBuilder.asString(outputProperties);
  }
 catch (  Exception e) {
    return null;
  }
}
