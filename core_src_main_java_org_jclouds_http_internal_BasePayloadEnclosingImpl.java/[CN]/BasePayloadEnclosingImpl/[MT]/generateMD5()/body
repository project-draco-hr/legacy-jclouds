{
  checkState(payload != null,"payload");
  if (!payload.isRepeatable()) {
    MD5InputStreamResult result=encryptionService.md5Result(payload.getInput());
    setContentMD5(result.md5);
    setContentLength(result.length);
    setPayload(result.data);
  }
 else {
    setContentMD5(encryptionService.md5(payload.getInput()));
  }
}
