{
  if (clientOption.isPresent()) {
    FlavorExtraSpecsClient client=clientOption.get();
    testFlavor=Iterables.getLast(flavorClient.listFlavors());
    Map<String,String> before=client.getAllExtraSpecs(testFlavor.getId());
    assertNotNull(before);
    Map<String,String> specs=Maps.newHashMap(before);
    specs.putAll(testSpecs);
    assertTrue(client.setAllExtraSpecs(testFlavor.getId(),specs));
    assertEquals(client.getAllExtraSpecs(testFlavor.getId()),specs);
    for (    Map.Entry<String,String> entry : specs.entrySet()) {
      assertEquals(client.getExtraSpec(testFlavor.getId(),entry.getKey()),entry.getValue());
    }
  }
}
