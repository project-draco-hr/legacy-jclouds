{
  try {
    SessionTokenResponse response=gson.fromJson(new InputStreamReader(stream,"UTF-8"),SessionTokenResponse.class);
    if (response.ResponseCode == null || response.ResponseCode != 0)     throw new RuntimeException("bad response code: " + response.ResponseCode);
    Map<String,String> metadata=Maps.newHashMap();
    for (    Map<String,String> keyValue : response.Metadata) {
      metadata.put(keyValue.get("Type"),keyValue.get("Value"));
    }
    return metadata;
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException("jclouds requires UTF-8 encoding",e);
  }
}
