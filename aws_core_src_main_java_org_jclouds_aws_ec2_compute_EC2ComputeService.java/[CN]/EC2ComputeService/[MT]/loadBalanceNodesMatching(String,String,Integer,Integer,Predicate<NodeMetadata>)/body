{
  checkNotNull(loadBalancerName,"loadBalancerName");
  checkNotNull(protocol,"protocol");
  checkArgument(protocol.toUpperCase().equals("HTTP") || protocol.toUpperCase().equals("TCP"),"Acceptable values for protocol are HTTP or TCP");
  checkNotNull(loadBalancerPort,"loadBalancerPort");
  checkNotNull(instancePort,"instancePort");
  Location location=null;
  Set<String> ids=new HashSet<String>();
  for (  final NodeMetadata node : Iterables.filter(super.listNodesDetailsMatching(NodePredicates.all()),Predicates.and(filter,Predicates.not(NodePredicates.TERMINATED)))) {
    ids.add(node.getId());
    location=node.getLocation();
  }
  logger.debug(">> creating load balancer (%s)",loadBalancerName);
  String dnsName=loadBalancerStrategy.execute(location,loadBalancerName,protocol,loadBalancerPort,instancePort,ids);
  logger.debug("<< created load balancer (%s) DNS (%s)",loadBalancerName,dnsName);
  return dnsName;
}
