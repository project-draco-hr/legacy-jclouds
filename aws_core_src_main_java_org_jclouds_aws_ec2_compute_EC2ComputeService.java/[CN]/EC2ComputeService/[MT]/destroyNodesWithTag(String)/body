{
  logger.debug(">> terminating servers by tag(%s)",tag);
  Set<ListenableFuture<Void>> responses=Sets.newHashSet();
  for (  final NodeMetadata node : doGetNodes(tag)) {
    if (node.getState() != NodeState.TERMINATED)     responses.add(ConcurrentUtils.makeListenable(executor.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        destroyNode(node);
        return null;
      }
    }
),executor));
  }
  ConcurrentUtils.awaitCompletion(responses,executor,null,logger,"nodes");
  logger.debug("<< destroyed");
}
