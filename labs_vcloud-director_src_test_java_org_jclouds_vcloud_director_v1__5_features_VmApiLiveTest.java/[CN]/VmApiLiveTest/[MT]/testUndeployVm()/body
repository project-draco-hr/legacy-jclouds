{
  vm=powerOnVm(vm.getHref());
  UndeployVAppParams params=UndeployVAppParams.builder().build();
  Task undeploy=vmApi.undeploy(vm.getHref(),params);
  assertTrue(retryTaskSuccess.apply(undeploy),String.format(TASK_COMPLETE_TIMELY,"undeploy"));
  vm=vmApi.getVm(vm.getHref());
  assertFalse(vm.isDeployed(),String.format(OBJ_FIELD_EQ,VM,"deployed","FALSE",vm.isDeployed().toString()));
  assertVmStatus(vmURI,Status.POWERED_OFF);
}
