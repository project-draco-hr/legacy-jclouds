{
  ChefClient chef=createMock(ChefClient.class);
  Map<String,JsonBall> automatic=ImmutableMap.<String,JsonBall>of();
  Node node=new Node("name",ImmutableSet.<String>of());
  Supplier<Map<String,JsonBall>> automaticSupplier=Suppliers.<Map<String,JsonBall>>ofInstance(automatic);
  Node nodeWithAutomatic=new Node("name",ImmutableMap.<String,JsonBall>of(),ImmutableMap.<String,JsonBall>of(),ImmutableMap.<String,JsonBall>of(),automatic,ImmutableSet.<String>of());
  expect(chef.getNode("name")).andReturn(node);
  node.getAutomatic().putAll(automaticSupplier.get());
  expect(chef.updateNode(nodeWithAutomatic)).andReturn(null);
  replay(chef);
  UpdateNode updater=new UpdateNode(chef,automaticSupplier);
  updater.updateNode("name");
  verify(chef);
}
