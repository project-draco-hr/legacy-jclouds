{
  SSHJava task=makeSSHJava();
  task=directoryShift(task);
  assertEquals(task.shiftMap,ImmutableMap.<String,String>of(System.getProperty("user.home") + "/apache-maven-2.2.1","maven"));
  assertEquals(task.replace,ImmutableMap.<String,String>of(System.getProperty("user.name"),"root"));
  new File("build").mkdirs();
  Files.write(task.createInitScript(OsFamily.UNIX,"1","remotedir",task.env,task.getCommandLine()),new File("build","init.sh"),Charsets.UTF_8);
  task.remotedir=new File(task.remotebase,task.id);
  task.replaceAllTokensIn(new File("build"));
  assertEquals(Files.toString(new File("build","init.sh"),Charsets.UTF_8),Resources.toString(Resources.getResource("init.sh"),Charsets.UTF_8));
}
