{
  Set<HardDisk> hardDisks=controller.getHardDisks();
  for (  HardDisk hardDisk : hardDisks) {
    String sourcePath=hardDisk.getDiskPath();
    if (new File(sourcePath).exists()) {
      boolean deleted=new File(sourcePath).delete();
      if (!deleted) {
        logger.error(String.format("File %s could not be deleted.",sourcePath));
      }
    }
    IMedium medium=new CreateMediumIfNotAlreadyExists(manager,machineUtils,true).apply(hardDisk);
    ensureMachineDevicesAttached(vmName,medium,hardDisk.getDeviceDetails(),controller.getName());
  }
}
