{
  BaseMonitoringService service=monitoringService();
  Object monitoredObject1=new Object();
  Object monitoredObject2=new Object();
  CountingHandler handler=new CountingHandler(monitoredObject1,monitoredObject2);
  service.register(handler);
  service.monitor(new MockMonitor(),monitoredObject1,monitoredObject2);
  handler.lock();
  service.unregister(handler);
  assertEquals(handler.numCompletes,2);
  assertEquals(handler.numFailures,0);
  assertEquals(handler.numTimeouts,0);
}
