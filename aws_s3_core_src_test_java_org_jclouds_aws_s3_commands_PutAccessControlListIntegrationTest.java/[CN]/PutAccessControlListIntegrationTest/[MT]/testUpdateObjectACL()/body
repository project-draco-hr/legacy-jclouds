{
  String bucketName=getBucketName();
  try {
    String objectKey="private-acl";
    addObjectToBucket(bucketName,objectKey);
    AccessControlList acl=client.getObjectACL(bucketName,objectKey).get(10,TimeUnit.SECONDS);
    String ownerId=acl.getOwner().getId();
    assertEquals(acl.getGrants().size(),1);
    assertTrue(acl.hasPermission(ownerId,Permission.FULL_CONTROL));
    addGrantsToACL(acl);
    assertEquals(acl.getGrants().size(),4);
    assertTrue(client.putObjectACL(bucketName,objectKey,acl).get(10,TimeUnit.SECONDS));
    acl=client.getObjectACL(bucketName,objectKey).get(10,TimeUnit.SECONDS);
    checkGrants(acl);
    acl.revokeAllPermissions(new CanonicalUserGrantee(ownerId));
    if (!ownerId.equals(TEST_ACL_ID))     acl.revokeAllPermissions(new CanonicalUserGrantee(TEST_ACL_ID));
    assertEquals(acl.getGrants().size(),1);
    assertTrue(acl.hasPermission(GroupGranteeURI.ALL_USERS,Permission.READ));
    assertTrue(client.putObjectACL(bucketName,objectKey,acl).get(10,TimeUnit.SECONDS));
    acl=client.getObjectACL(bucketName,objectKey).get(10,TimeUnit.SECONDS);
    assertEquals(acl.getGrants().size(),1);
    assertEquals(acl.getPermissions(ownerId).size(),0);
    assertTrue(acl.hasPermission(GroupGranteeURI.ALL_USERS,Permission.READ),acl.toString());
  }
  finally {
    returnBucket(bucketName);
  }
}
