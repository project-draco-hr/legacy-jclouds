{
  return new Predicate<VirtualDatacenter>(){
    @Override public boolean apply(    final VirtualDatacenter vdc){
      HypervisorType type=vdc.getHypervisorType();
      boolean compatible=type.isCompatible(template.getDiskFormatType());
      if (!compatible) {
        List<Conversion> compatibleConversions=template.listConversions(type,ConversionState.FINISHED);
        compatible=compatibleConversions != null && !compatibleConversions.isEmpty();
      }
      return compatible;
    }
  }
;
}
