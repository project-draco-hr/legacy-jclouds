{
  ScheduledFuture mockFuture=EasyMock.createMock(ScheduledFuture.class);
  ScheduledExecutorService schedulerMock=EasyMock.createMock(ScheduledExecutorService.class);
  expect(schedulerMock.scheduleWithFixedDelay(anyObject(Runnable.class),anyLong(),anyLong(),anyObject(TimeUnit.class))).andReturn(mockFuture);
  replay(mockFuture);
  replay(schedulerMock);
  AsyncMonitor<Object> monitor=mockMonitor(schedulerMock,new Object(),mockFunction(MonitorStatus.DONE),new EventBus());
  assertNull(monitor.getFuture());
  assertNull(monitor.getTimeout());
  monitor.startMonitoring(1L,TimeUnit.MINUTES);
  assertNotNull(monitor.getFuture());
  assertNotNull(monitor.getTimeout());
  assertTrue(monitor.getTimeout() > TimeUnit.MINUTES.toMillis(1));
  verify(mockFuture);
  verify(schedulerMock);
}
