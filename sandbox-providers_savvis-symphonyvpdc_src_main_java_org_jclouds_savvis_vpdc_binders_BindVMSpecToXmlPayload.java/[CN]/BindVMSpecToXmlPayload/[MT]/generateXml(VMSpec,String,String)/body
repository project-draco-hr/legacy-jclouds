{
  checkNotNull(spec,"VMSpec");
  checkNotNull(name,"name");
  checkNotNull(networkName,"networkName");
  try {
    XMLBuilder rootBuilder=buildRootForName(name);
    addOperatingSystemSection(rootBuilder,spec.getOperatingSystem());
    addVirtualHardwareSection(rootBuilder,name,networkName,spec);
    Properties outputProperties=new Properties();
    outputProperties.put(javax.xml.transform.OutputKeys.OMIT_XML_DECLARATION,"yes");
    return rootBuilder.asString(outputProperties);
  }
 catch (  Exception e) {
    return null;
  }
}
