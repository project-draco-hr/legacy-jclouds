{
  String containerName=containerPrefix + ".testObjectOperations";
  long size=1024;
  UploadInfo uploadInfo=connection.getStorageNode(containerName,size);
  assertNotNull(uploadInfo.getHost());
  assertNotNull(uploadInfo.getToken());
  Blob blob=connection.newBlob();
  blob.getMetadata().setName("test.txt");
  blob.setData("value");
  blob.generateMD5();
  byte[] md5=blob.getMetadata().getContentMD5();
  connection.upload(uploadInfo.getHost(),uploadInfo.getToken(),containerName,blob).get(30,TimeUnit.SECONDS);
  Map<String,String> metadata=connection.getMetadata(containerName + "/test.txt").get(30,TimeUnit.SECONDS);
  assertEquals(metadata,ImmutableMap.of("MD5",HttpUtils.toBase64String(md5)));
  String content=connection.getFile(containerName + "/test.txt").get(30,TimeUnit.SECONDS);
  assertEquals(content,"value");
  metadata=ImmutableMap.of("chef","sushi","foo","bar");
  connection.setMetadata(containerName + "/test.txt",metadata).get(30,TimeUnit.SECONDS);
  metadata=connection.getMetadata(containerName + "/test.txt").get(30,TimeUnit.SECONDS);
  assertEquals(metadata,ImmutableMap.<String,String>builder().putAll(metadata).put("MD5",HttpUtils.toBase64String(md5)).build());
}
