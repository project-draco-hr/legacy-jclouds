{
  ContextBuilder builder=ContextBuilder.newBuilder(provider).credentials(identity,credential).endpoint(endpoint).modules(ImmutableSet.<Module>of(new SLF4JLoggingModule(),new SshjSshClientModule())).overrides(overrides);
  userContext=VCloudDirectorContext.class.cast(builder.build());
  Link admin=Iterables.tryFind(userContext.getApi().getCurrentSession().getLinks(),Predicates.and(LinkPredicates.relEquals(Link.Rel.DOWN),ReferencePredicates.typeEquals(VCloudDirectorMediaType.ADMIN))).orNull();
  if (admin != null) {
    adminContext=userContext.getAdminContext();
    Reference orgRef=Iterables.getFirst(userContext.getApi().getOrgApi().list(),null).toAdminReference(endpoint);
    Reference userRef=Iterables.find(adminContext.getApi().getOrgApi().get(orgRef.getHref()).getUsers(),ReferencePredicates.nameEquals(adminContext.getApi().getCurrentSession().getUser()));
    User user=adminContext.getApi().getUserApi().get(userRef.getHref());
    Reference userRole=user.getRole();
    assertEquals(userRole.getName(),DefaultRoles.ORG_ADMIN.value());
  }
}
