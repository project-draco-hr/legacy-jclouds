{
  NodeMetadataBuilder builder=new NodeMetadataBuilder();
  builder.ids(from.getId() + "");
  builder.name(from.getNotes());
  builder.location(findLocationForVirtualGuest.apply(from));
  builder.group(parseGroupFromName(from.getNotes()));
  Image image=findImageForVirtualGuest.apply(from);
  if (image != null)   builder.operatingSystem(image.getOperatingSystem());
  builder.hardware(findHardwareForVirtualGuest.apply(from));
  builder.publicAddresses(ImmutableSet.<String>of(from.getPrimaryIpAddress()));
  builder.privateAddresses(ImmutableSet.<String>of(from.getPrimaryBackendIpAddress()));
  builder.credentials(credentialStore.get("node#" + from.getId()));
  return builder.build();
}
