{
  httpStreamUrl=checkNotNull(httpStreamUrl != null ? httpStreamUrl : sysHttpStreamUrl,"httpStreamUrl");
  httpStreamMd5=checkNotNull(httpStreamMd5 != null ? httpStreamMd5 : sysHttpStreamMd5,"httpStreamMd5");
  String key="hello";
  URL url=new URL(httpStreamUrl);
  byte[] md5=S3Utils.fromHexString(httpStreamMd5);
  URLConnection connection=url.openConnection();
  int length=connection.getContentLength();
  InputStream input=connection.getInputStream();
  S3Object object=new S3Object(key,input);
  object.setContentLength(length);
  object.getMetadata().setMd5(md5);
  object.getMetadata().setSize(length);
  String bucketName=getBucketName();
  try {
    byte[] newMd5=client.putObject(bucketName,object).get(30,TimeUnit.SECONDS);
    assertEquals(newMd5,md5);
  }
  finally {
    returnBucket(bucketName);
  }
}
