{
  VirtualBoxManager manager=(VirtualBoxManager)context.getProviderSpecificContext().getApi();
  new UnregisterMachineIfExistsAndDeleteItsMedia(manager).apply(masterSpec);
  IMachine master=new CreateAndRegisterMachineFromIsoIfNotAlreadyExists(manager,workingDir).apply(masterSpec);
  IMachine clone=new CloneAndRegisterMachineFromIMachineIfNotAlreadyExists(manager,workingDir,cloneSpec,!IS_LINKED_CLONE).apply(master);
  assertFalse(new IsLinkedClone(manager).apply(clone));
  new UnregisterMachineIfExistsAndDeleteItsMedia(manager).apply(new IMachineToVmSpec().apply(clone));
  new UnregisterMachineIfExistsAndDeleteItsMedia(manager).apply(masterSpec);
}
