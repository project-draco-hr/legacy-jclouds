{
  INetworkAdapter networkAdapter=machine.getNetworkAdapter(adapterSlot);
  networkAdapter.setAttachmentType(NAT);
  for (  RedirectRule rule : natAdapter.getRedirectRules()) {
    try {
      String ruleName=String.format("%s@%s:%s->%s:%s",rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
      networkAdapter.getNatDriver().addRedirect(ruleName,rule.getProtocol(),rule.getHost(),rule.getHostPort(),rule.getGuest(),rule.getGuestPort());
    }
 catch (    VBoxException e) {
      if (e.getMessage().indexOf("already exists") == -1)       throw e;
    }
  }
  networkAdapter.setEnabled(true);
  machine.saveSettings();
  return null;
}
