{
  if (command == null) {
    throw new BuildException("Command is required.");
  }
  if (host == null) {
    throw new BuildException("Host is required.");
  }
  if (userInfo.getName() == null) {
    throw new BuildException("Username is required.");
  }
  if (userInfo.getKeyfile() == null && userInfo.getPassword() == null) {
    throw new BuildException("Password or Keyfile is required.");
  }
  Session session=null;
  try {
    session=openSession();
    return executeCommand(session,command);
  }
  finally {
    if (session != null && session.isConnected()) {
      session.disconnect();
    }
  }
}
