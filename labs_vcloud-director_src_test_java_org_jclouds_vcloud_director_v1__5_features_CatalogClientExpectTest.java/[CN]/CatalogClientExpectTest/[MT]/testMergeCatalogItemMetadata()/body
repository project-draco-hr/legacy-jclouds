{
  HttpRequest catalogItemRequest=HttpRequest.builder().method("POST").endpoint(URI.create(endpoint + "/catalogItem/a36fdac9-b8c2-43e2-9a4c-2ffaf3ee13df/metadata")).headers(ImmutableMultimap.<String,String>builder().put("Accept","application/vnd.vmware.vcloud.task+xml").put("x-vcloud-authorization",token).build()).payload(payloadFromResourceWithContentType("/catalog/mergeCatalogItemMetadata.xml",VCloudDirectorMediaType.METADATA)).build();
  HttpResponse catalogItemResponse=HttpResponse.builder().statusCode(200).payload(payloadFromResourceWithContentType("/catalog/mergeMetadataTask.xml",VCloudDirectorMediaType.TASK + ";version=1.5")).build();
  VCloudDirectorClient client=requestsSendResponses(loginRequest,sessionResponse,catalogItemRequest,catalogItemResponse);
  Reference catalogItemReference=Reference.builder().type("application/vnd.vmware.vcloud.catalogItem+xml").name("ubuntu10").href(URI.create("https://vcloudbeta.bluelock.com/api/catalogItem/a36fdac9-b8c2-43e2-9a4c-2ffaf3ee13df")).build();
  Metadata metadata=Metadata.builder().entry(MetadataEntry.builder().entry("KEY","VALUE").build()).build();
  Task expected=mergeMetadataTask();
  assertEquals(client.getCatalogClient().getMetadataClient().mergeMetadata(catalogItemReference,metadata),expected);
}
