{
  checkNotNull(request,"request must be present");
  Multimap<String,String> decodedParams=Queries.parseQueryToMap(request.getEndpoint().getRawQuery());
  addSigningParams(decodedParams);
  String stringToSign=createStringToSign(request,decodedParams);
  String signature=sign(stringToSign);
  addSignature(decodedParams,signature);
  request=request.toBuilder().endpoint(builder.get().uri(request.getEndpoint()).replaceQuery(Queries.makeQueryLine(decodedParams,null)).build()).build();
  utils.logRequest(signatureLog,request,"<<");
  return request;
}
