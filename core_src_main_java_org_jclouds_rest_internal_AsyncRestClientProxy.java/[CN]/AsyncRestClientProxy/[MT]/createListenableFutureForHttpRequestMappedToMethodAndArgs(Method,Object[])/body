{
  method=annotationProcessor.getDelegateOrNull(method);
  String name=method.getDeclaringClass().getSimpleName() + "." + method.getName();
  logger.trace(">> converting %s",name);
  FutureFallback<?> fallback=fallbacks.getUnchecked(method);
  if (fallback instanceof InvocationContext) {
    InvocationContext.class.cast(fallback).setContext((HttpRequest)null);
  }
  ListenableFuture<?> result;
  try {
    GeneratedHttpRequest request=annotationProcessor.createRequest(method,args);
    if (fallback instanceof InvocationContext) {
      InvocationContext.class.cast(fallback).setContext(request);
    }
    logger.trace("<< converted %s to %s",name,request.getRequestLine());
    Function<HttpResponse,?> transformer=annotationProcessor.createResponseParser(method,request);
    logger.trace("<< response from %s is parsed by %s",name,transformer.getClass().getSimpleName());
    logger.debug(">> invoking %s",name);
    result=commandFactory.create(request,transformer).execute();
  }
 catch (  RuntimeException e) {
    AuthorizationException aex=Throwables2.getFirstThrowableOfType(e,AuthorizationException.class);
    if (aex != null)     e=aex;
    try {
      return fallback.create(e);
    }
 catch (    Exception ex) {
      return immediateFailedFuture(ex);
    }
  }
  logger.trace("<< exceptions from %s are parsed by %s",name,fallback.getClass().getSimpleName());
  return withFallback(result,fallback);
}
