{
  String nodeName="test-attach-medium-node-1";
  String controllerName="My Controller";
  new UnregisterMachineIfExists(manager,CleanupMode.Full).apply(nodeName);
  String path=System.getProperty("user.home") + "/jclouds-virtualbox-test/test-attach-medium-1.vdi";
  new CreateAndRegisterMachineFromIsoIfNotAlreadyExists("Debian",nodeName,true,manager).apply(nodeName);
  lockMachineAndApply(manager,LockType.Write,nodeName,new AddIDEControllerIfNotExists(controllerName));
  IMedium medium=new CreateMediumIfNotAlreadyExists(manager,"vdi",true).apply(path);
  lockMachineAndApply(manager,LockType.Write,nodeName,new AttachDistroMediumToMachine(controllerName,medium));
  new UnregisterMachineIfExists(manager,CleanupMode.Full).apply(nodeName);
  medium.close();
  assertFileCanBeDeleted(path);
}
