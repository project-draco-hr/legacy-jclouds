{
  nodes=ImmutableSet.copyOf(Iterables.transform(nodes,new Function<NodeMetadata,NodeMetadata>(){
    @Override public NodeMetadata apply(    NodeMetadata arg0){
      Map<String,String> md=metadataForId(arg0.getProviderId(),group,template.getOptions().getUserMetadata());
      return NodeMetadataBuilder.fromNodeMetadata(arg0).name(md.get("Name")).userMetadata(md).build();
    }
  }
));
  return nodes;
}
