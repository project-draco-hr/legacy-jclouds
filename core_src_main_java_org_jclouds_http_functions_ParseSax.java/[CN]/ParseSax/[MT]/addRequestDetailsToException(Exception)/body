{
  String exceptionMessage=e.getMessage();
  if (e instanceof SAXParseException) {
    SAXParseException parseException=(SAXParseException)e;
    String systemId=parseException.getSystemId();
    if (systemId == null) {
      systemId="";
    }
    exceptionMessage=String.format("Error on line %d of document %s: %s",systemId,parseException.getLineNumber(),parseException.getMessage());
  }
  if (request != null) {
    StringBuilder message=new StringBuilder();
    message.append("Error parsing input for ").append(request.getRequestLine()).append(": ");
    message.append(exceptionMessage);
    logger.error(e,message.toString());
    throw new RuntimeException(message.toString(),e);
  }
 else {
    logger.error(e,exceptionMessage.toString());
    throw new RuntimeException(exceptionMessage.toString(),e);
  }
}
