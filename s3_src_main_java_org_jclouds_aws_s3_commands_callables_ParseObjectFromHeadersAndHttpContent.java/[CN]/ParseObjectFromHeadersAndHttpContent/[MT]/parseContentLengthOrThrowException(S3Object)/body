{
  String contentLength=getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_LENGTH);
  String contentRange=getResponse().getFirstHeaderOrNull(HttpHeaders.CONTENT_RANGE);
  if (contentLength == null)   throw new HttpException(HttpHeaders.CONTENT_LENGTH + " header not present in headers: " + getResponse().getHeaders());
  object.setContentLength(Long.parseLong(contentLength));
  if (contentRange == null) {
    object.getMetadata().setSize(object.getContentLength());
  }
 else {
    object.setContentRange(contentRange);
    object.getMetadata().setSize(Long.parseLong(contentRange.substring(contentRange.lastIndexOf('/') + 1)));
  }
}
