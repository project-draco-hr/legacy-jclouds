{
  checkState(data != null,"data");
  if (data instanceof InputStream) {
    MD5InputStreamResult result=HttpUtils.generateMD5Result((InputStream)data);
    getMetadata().setSize(result.length);
    getMetadata().setContentMD5(result.eTag);
    setData(result.data);
  }
 else {
    getMetadata().setContentMD5(HttpUtils.md5(data));
  }
}
