{
  String containerName=getContainerName();
  String destinationContainer=getContainerName();
  try {
    DateTime before=new DateTime();
    addToContainerAndValidate(containerName,sourceKey + "mod");
    DateTime after=new DateTime().plusSeconds(1);
    client.copyBlob(containerName,sourceKey + "mod",destinationContainer,destinationKey,ifSourceModifiedSince(before)).get(10,TimeUnit.SECONDS);
    validateContent(destinationContainer,destinationKey);
    try {
      client.copyBlob(containerName,sourceKey + "mod",destinationContainer,destinationKey,ifSourceModifiedSince(after)).get(10,TimeUnit.SECONDS);
    }
 catch (    ExecutionException e) {
      if (e.getCause() instanceof HttpResponseException) {
        HttpResponseException ex=(HttpResponseException)e.getCause();
        assertEquals(ex.getResponse().getStatusCode(),412);
      }
 else {
        throw e;
      }
    }
  }
  finally {
    returnContainer(containerName);
    returnContainer(destinationContainer);
  }
}
