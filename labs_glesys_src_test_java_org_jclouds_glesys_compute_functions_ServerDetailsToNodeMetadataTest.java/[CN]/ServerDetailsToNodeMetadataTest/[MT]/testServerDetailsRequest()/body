{
  ServerDetailsToNodeMetadata toTest=injectorForKnownArgumentsAndConstantPassword(ImmutableMap.<HttpRequest,HttpResponse>builder().put(HttpRequest.builder().method("POST").endpoint(URI.create("https://api.glesys.com/server/details/format/json")).headers(ImmutableMultimap.<String,String>builder().put("Accept","application/json").put("Authorization","Basic aWRlbnRpdHk6Y3JlZGVudGlhbA==").build()).payload(newUrlEncodedFormPayload(ImmutableMultimap.<String,String>builder().put("serverid","xm3276891").build())).build(),HttpResponse.builder().statusCode(200).payload(payloadFromString("{\"response\":{\"status\":{\"code\":200,\"timestamp\":\"2012-02-10T11:28:50+01:00\",\"text\":\"OK\"},\"server\":{\"state\":\"running\"},\"debug\":{\"input\":{\"serverid\":\"xm3276891\",\"statustype\":\"state\"}}}}")).build()).put(HttpRequest.builder().method("POST").endpoint(URI.create("https://api.glesys.com/server/status/format/json")).headers(ImmutableMultimap.<String,String>builder().put("Accept","application/json").put("Authorization","Basic aWRlbnRpdHk6Y3JlZGVudGlhbA==").build()).payload(newUrlEncodedFormPayload(ImmutableMultimap.<String,String>builder().put("serverid","xm3276891").put("statustype","state").build())).build(),HttpResponse.builder().statusCode(206).payload(payloadFromResource("/server_status.json")).build()).build()).getInstance(ServerDetailsToNodeMetadata.class);
  assertEquals(toTest.apply(ServerClientExpectTest.expectedServerDetails()),new NodeMetadataBuilder().ids("xm3276891").name("glesys-s-6dd").hostname("glesys-s-6dd").group("glesys-s").imageId("Ubuntu 11.04 x64").operatingSystem(OperatingSystem.builder().name("Ubuntu 11.04 x64").family(OsFamily.UBUNTU).version("11.04").is64Bit(true).description("Ubuntu 11.04 x64").build()).publicAddresses(ImmutableSet.of("109.74.10.45")).hardware(new HardwareBuilder().ids("xm3276891").ram(512).processors(ImmutableList.of(new Processor(1,1.0))).volumes(ImmutableList.<Volume>of(new VolumeImpl(5f,true,true))).hypervisor("Xen").build()).state(NodeState.RUNNING).build());
}
