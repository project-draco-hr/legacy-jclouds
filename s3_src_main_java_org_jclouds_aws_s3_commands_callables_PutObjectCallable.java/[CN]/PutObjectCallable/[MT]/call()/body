{
  if (getResponse().getStatusCode() == 200) {
    try {
      getResponse().getContent().close();
    }
 catch (    IOException e) {
      logger.error(e,"error consuming content");
    }
    String eTag=getResponse().getFirstHeaderOrNull("ETag");
    if (eTag != null) {
      return S3Utils.fromHexString(eTag.replaceAll("\"",""));
    }
    throw new HttpException("did not receive ETag");
  }
 else {
    try {
      String reason=S3Utils.toStringAndClose(getResponse().getContent());
      throw new HttpException(getResponse().getStatusCode() + ": Problem uploading content.\n" + reason);
    }
 catch (    IOException e) {
      throw new HttpException(getResponse().getStatusCode() + ": Problem uploading content",e);
    }
  }
}
