{
  logger.debug(">> destroying nodes matching(%s)",filter);
  Set<NodeMetadata> set=Sets.newLinkedHashSet(transformParallel(nodesMatchingFilterAndNotTerminated(filter),new Function<NodeMetadata,Future<NodeMetadata>>(){
    @Override public Future<NodeMetadata> apply(    final NodeMetadata from){
      return executor.submit(new Callable<NodeMetadata>(){
        @Override public NodeMetadata call() throws Exception {
          destroyNode(from.getId());
          return from;
        }
      }
);
    }
  }
,executor,null,logger,"destroying nodes"));
  logger.debug("<< destroyed(%d)",set.size());
  return set;
}
