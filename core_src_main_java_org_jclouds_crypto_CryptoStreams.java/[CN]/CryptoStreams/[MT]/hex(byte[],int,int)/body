{
  char[] hex=new char[2 * len];
  int index=0;
  for (int i=offset; i < offset + len; ++i) {
    byte b=in[i];
    int v=b & 0xFF;
    hex[index++]=HEX_CHAR_TABLE[v >>> 4];
    hex[index++]=HEX_CHAR_TABLE[v & 0xF];
  }
  return hex;
}
