{
  return com.google.common.io.ByteStreams.readBytes(checkNotNull(supplier,"supplier"),new ByteProcessor<byte[]>(){
    public boolean processBytes(    byte[] buf,    int off,    int len){
      mac.update(buf,off,len);
      return true;
    }
    public byte[] getResult(){
      return mac.doFinal();
    }
  }
);
}
