{
  checkNotNull(loadBalancerName,"loadBalancerName");
  checkNotNull(protocol,"protocol");
  checkArgument(protocol.toUpperCase().equals("HTTP") || protocol.toUpperCase().equals("TCP"),"Acceptable values for protocol are HTTP or TCP");
  Map<Location,Set<String>> locationMap=Maps.newHashMap();
  for (  NodeMetadata node : Iterables.filter(context.getComputeService().listNodesDetailsMatching(NodePredicates.all()),Predicates.and(filter,Predicates.not(NodePredicates.TERMINATED)))) {
    Set<String> ids=locationMap.get(node.getLocation());
    if (ids == null)     ids=Sets.newHashSet();
    ids.add(node.getProviderId());
    locationMap.put(node.getLocation(),ids);
  }
  Set<String> dnsNames=Sets.newHashSet();
  for (  Location location : locationMap.keySet()) {
    logger.debug(">> creating load balancer (%s)",loadBalancerName);
    String dnsName=loadBalancerStrategy.execute(location,loadBalancerName,protocol,loadBalancerPort,instancePort,locationMap.get(location));
    dnsNames.add(dnsName);
    logger.debug("<< created load balancer (%s) DNS (%s)",loadBalancerName,dnsName);
  }
  return dnsNames;
}
