{
  try {
    String identity=in.identity;
    String privateKeyInPemFormat=in.credential;
    if (keyFactoryAlgorithm.equals(NO_ALGORITHM)) {
      return new OAuthCredentials.Builder().identity(identity).credential(privateKeyInPemFormat).build();
    }
    KeyFactory keyFactory=KeyFactory.getInstance(keyFactoryAlgorithm);
    PrivateKey privateKey=keyFactory.generatePrivate(privateKeySpec(newStringPayload(privateKeyInPemFormat)));
    return new OAuthCredentials.Builder().identity(identity).credential(privateKeyInPemFormat).privateKey(privateKey).build();
  }
 catch (  IOException e) {
    throw propagate(e);
  }
catch (  GeneralSecurityException e) {
    throw new AuthorizationException("security exception loading credentials. " + e.getMessage(),e);
  }
catch (  IllegalArgumentException e) {
    throw new AuthorizationException("cannot parse pk. " + e.getMessage(),e);
  }
}
