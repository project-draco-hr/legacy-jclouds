{
  addContextModule(modules);
  addClientModuleIfNotPresent(modules);
  addLoggingModuleIfNotPresent(modules);
  addHttpModuleIfNeededAndNotPresent(modules);
  ifHttpConfigureRestOtherwiseGuiceClientFactory(modules);
  addExecutorServiceIfNotPresent(modules);
  modules.add(new BindPropertiesAndPrincipalContext(properties));
  return Guice.createInjector(modules);
}
