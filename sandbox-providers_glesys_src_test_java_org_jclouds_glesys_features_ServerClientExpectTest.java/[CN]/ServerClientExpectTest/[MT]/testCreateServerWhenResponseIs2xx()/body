{
  ServerClient client=requestSendsResponse(HttpRequest.builder().method("POST").endpoint(URI.create("https://api.glesys.com/server/create/format/json")).headers(ImmutableMultimap.<String,String>builder().put("Accept","application/json").put("Authorization","Basic aWRlbnRpdHk6Y3JlZGVudGlhbA==").build()).payload(newUrlEncodedFormPayload(ImmutableMultimap.<String,String>builder().put("hostname","jclouds-test").put("rootpassword","password").put("datacenter","Falkenberg").put("platform","OpenVZ").put("templatename","Ubuntu 32-bit").put("disksize","5").put("memorysize","512").put("cpucores","1").put("transfer","50").build())).build(),HttpResponse.builder().statusCode(200).payload(payloadFromResource("/server_noip.json")).build()).getServerClient();
  Cost cost=Cost.builder().amount(6.38).currency("EUR").timePeriod("month").build();
  ServerDetails expected=ServerDetails.builder().id("vz1541880").hostname("mammamia").datacenter("Falkenberg").platform("OpenVZ").templateName("Ubuntu 11.04 64-bit").description("description").cpuCores(1).memorySize(128).diskSize(5).transfer(50).cost(cost).build();
  assertEquals(client.createServerWithHostnameAndRootPassword(ServerSpec.builder().datacenter("Falkenberg").platform("OpenVZ").templateName("Ubuntu 32-bit").diskSizeGB(5).memorySizeMB(512).cpuCores(1).transferGB(50).build(),"jclouds-test","password").toString(),expected.toString());
}
