{
  return lockSessionOnMachineAndApply(machineId,LockType.Shared,new Function<ISession,T>(){
    @Override public T apply(    ISession session){
      return function.apply(session.getMachine());
    }
    @Override public String toString(){
      return function.toString();
    }
  }
);
}
