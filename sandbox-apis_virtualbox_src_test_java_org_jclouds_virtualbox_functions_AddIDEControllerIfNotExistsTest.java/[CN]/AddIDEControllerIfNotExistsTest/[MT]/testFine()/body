{
  IMachine vm=createMock(IMachine.class);
  String controllerName="IDE Controller";
  StorageController storageController=StorageController.builder().bus(StorageBus.IDE).name(controllerName).build();
  expect(vm.addStorageController(controllerName,StorageBus.IDE)).andReturn(createNiceMock(IStorageController.class));
  vm.saveSettings();
  replay(vm);
  new AddIDEControllerIfNotExists(storageController).apply(vm);
  verify(vm);
}
