{
  TemplateBuilder templateBuilder=computeService.templateBuilder();
  if (nodeElement.getLocation() != null && !"".equals(nodeElement.getLocation()))   templateBuilder.locationId(nodeElement.getLocation());
  if (nodeElement.getImage() != null && !"".equals(nodeElement.getImage())) {
    final String imageId=nodeElement.getImage();
    try {
      templateBuilder.imageId(imageId);
    }
 catch (    NoSuchElementException e) {
      throw new BuildException("image not found " + nodeElement.getImage());
    }
  }
 else {
    templateBuilder.osFamily(OsFamily.valueOf(nodeElement.getOs()));
  }
  addHardwareFromElementToTemplate(nodeElement,templateBuilder);
  templateBuilder.options(getNodeOptionsFromElement(nodeElement));
  return templateBuilder.build();
}
