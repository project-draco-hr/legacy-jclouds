{
  ParseAWSErrorFromXmlContent function=Guice.createInjector(new ParserModule(),new AbstractModule(){
    @Override protected void configure(){
      bind(RequestSigner.class).toInstance(createMock(RequestSigner.class));
    }
  }
).getInstance(ParseAWSErrorFromXmlContent.class);
  HttpCommand command=createMock(HttpCommand.class);
  HttpRequest request=new HttpRequest(method,uri);
  HttpResponse response=new HttpResponse(Utils.toInputStream(content));
  response.setStatusCode(statusCode);
  response.setMessage(message);
  expect(command.getRequest()).andReturn(request).atLeastOnce();
  command.setException(classEq(expected));
  replay(command);
  function.handleError(command,response);
  verify(command);
}
