{
  try {
    ISession machineSession=manager.openMachineSession(machine);
    IProgress progress=machineSession.getConsole().powerDown();
    progress.waitForCompletion(-1);
    machineSession.unlockMachine();
    while (!machine.getSessionState().equals(SessionState.Unlocked)) {
      try {
        System.out.println("waiting for unlocking session - session state: " + machine.getSessionState());
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
