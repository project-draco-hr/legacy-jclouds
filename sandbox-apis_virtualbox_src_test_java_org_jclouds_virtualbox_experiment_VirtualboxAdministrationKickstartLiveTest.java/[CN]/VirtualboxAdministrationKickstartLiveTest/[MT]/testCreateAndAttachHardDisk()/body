{
  IMedium hd=null;
  if (!new File(clonedDisk).exists()) {
    hd=manager.getVBox().createHardDisk(diskFormat,clonedDisk);
    long size=4L * 1024L * 1024L* 1024L - 4L;
    IProgress progress=hd.createBaseStorage(new Long(size),new Long(MediumVariant.STANDARD.ordinal()));
  }
  ISession session=manager.getSessionObject();
  IMachine machine=manager.getVBox().findMachine(vmName);
  machine.lockMachine(session,LockType.Write);
  IMachine mutable=session.getMachine();
  mutable.attachDevice(controllerIDE,0,1,DeviceType.HardDisk,hd);
  mutable.saveSettings();
  session.unlockMachine();
  assertEquals(hd.getId().equals(""),false);
}
