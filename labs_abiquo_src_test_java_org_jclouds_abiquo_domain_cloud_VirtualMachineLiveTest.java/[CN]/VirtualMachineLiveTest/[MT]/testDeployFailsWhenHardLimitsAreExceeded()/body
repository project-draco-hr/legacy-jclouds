{
  Enterprise ent=view.getAdministrationService().getCurrentEnterprise();
  if (vdc.getCpuCountHardLimit() != 0) {
    vm.setCpu(vdc.getCpuCountHardLimit() + 1);
  }
 else   if (ent.getCpuCountHardLimit() != 0) {
    vm.setCpu(ent.getCpuCountHardLimit() + 1);
  }
  AsyncTask task=vm.update();
  assertNull(task);
  try {
    vm.deploy(true);
    fail("Deployments over the hard limits should not be allowed");
  }
 catch (  AbiquoException ex) {
    assertHasError(ex,Status.CONFLICT,"LIMIT_EXCEEDED");
  }
}
