{
  PCSUtil connection=createPCSUtil();
  AddMetadataAndParseResourceIdIntoBytes function=new AddMetadataAndParseResourceIdIntoBytes(connection);
  PCSFile pcsFile=new PCSFile("key");
  pcsFile.getMetadata().getUserMetadata().put("foo","bar");
  pcsFile.getMetadata().getUserMetadata().put("biz","baz");
  function.setContext(new HttpRequest("GET",URI.create("http://localhost:8080")),new Object[]{pcsFile});
  response.setContent(IOUtils.toInputStream("http://localhost/contents/7F143552-AAF5-11DE-BBB0-0BC388ED913B"));
  byte[] eTag=function.apply(response);
  byte[] expected=HttpUtils.fromHexString("7F143552AAF511DEBBB00BC388ED913B");
  assertEquals(eTag,expected);
  verify(connection);
}
