{
  HttpRequest listWithOptions=HttpRequest.builder().method("POST").endpoint("https://iam.amazonaws.com/").addHeader("Host","iam.amazonaws.com").addFormParam("Action","ListUsers").addFormParam("Marker","MARKER").addFormParam("PathPrefix","%2Ffoo").addFormParam("Signature","1%2BeCgNIAjHr%2BraNdDd3rsVC5Qok3AuTrJOa5mZwmE7g%3D").addFormParam("SignatureMethod","HmacSHA256").addFormParam("SignatureVersion","2").addFormParam("Timestamp","2009-11-08T15%3A54%3A08.897Z").addFormParam("Version","2010-05-08").addFormParam("AWSAccessKeyId","identity").build();
  HttpResponse listWithOptionsResponse=HttpResponse.builder().statusCode(200).payload(payloadFromResourceWithContentType("/list_users.xml","text/xml")).build();
  IAMApi apiWhenWithOptionsExist=requestSendsResponse(listWithOptions,listWithOptionsResponse);
  assertEquals(apiWhenWithOptionsExist.getUserApi().list(pathPrefix("/foo").afterMarker("MARKER")).toString(),new ListUsersResponseTest().expected().toString());
}
