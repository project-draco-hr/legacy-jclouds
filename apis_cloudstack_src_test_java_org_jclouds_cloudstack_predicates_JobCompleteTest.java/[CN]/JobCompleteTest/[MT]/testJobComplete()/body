{
  CloudStackClient client=createMock(CloudStackClient.class);
  AsyncJobClient asyncJobClient=createMock(AsyncJobClient.class);
  expect(client.getAsyncJobClient()).andReturn(asyncJobClient);
  AsyncJob job=AsyncJob.builder().id(100L).status(SUCCEEDED.code()).resultCode(SUCCESS.code()).build();
  expect(asyncJobClient.getAsyncJob(job.getId())).andReturn(job);
  replay(client,asyncJobClient);
  assertTrue(new JobComplete(client).apply(job.getId()));
  verify(client,asyncJobClient);
}
