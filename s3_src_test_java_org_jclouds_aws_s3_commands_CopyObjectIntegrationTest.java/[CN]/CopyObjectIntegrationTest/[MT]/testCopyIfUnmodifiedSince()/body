{
  String sourceBucket=bucketPrefix + "testCopyIfUnmodifiedSince";
  String sourceKey="apples";
  String destinationBucket=bucketPrefix + "testCopyIfUnmodifiedSinceDestination";
  String destinationKey="pears";
  DateTime before=new DateTime();
  setupSourceBucket(sourceBucket,sourceKey);
  DateTime after=new DateTime().plusSeconds(1);
  createBucketAndEnsureEmpty(destinationBucket);
  client.copyObject(sourceBucket,sourceKey,destinationBucket,destinationKey,ifSourceUnmodifiedSince(after)).get(10,TimeUnit.SECONDS);
  validateContent(destinationBucket,destinationKey);
  try {
    client.copyObject(sourceBucket,sourceKey,destinationBucket,destinationKey,ifSourceModifiedSince(before)).get(10,TimeUnit.SECONDS);
  }
 catch (  ExecutionException e) {
    S3ResponseException ex=(S3ResponseException)e.getCause();
    assertEquals(ex.getResponse().getStatusCode(),412);
  }
}
