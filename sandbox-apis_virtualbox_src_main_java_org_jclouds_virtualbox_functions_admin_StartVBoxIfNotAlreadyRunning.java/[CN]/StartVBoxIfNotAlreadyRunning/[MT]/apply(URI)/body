{
  checkState(compute.getNodeMetadata(hostId) != null,"compute service %s cannot locate node with id %s",compute,hostId);
  checkNotNull(endpoint,"endpoint to virtualbox websrvd is needed");
  if (socketTester.apply(new IPSocket(endpoint.getHost(),endpoint.getPort()))) {
    manager.connect(endpoint.toASCIIString(),credentials.identity,credentials.credential);
    return manager;
  }
  logger.debug("disabling password access");
  compute.runScriptOnNode(hostId,"VBoxManage setproperty websrvauthlibrary null",runAsRoot(false).wrapInInitScript(false));
  logger.debug("starting vboxwebsrv");
  String vboxwebsrv="vboxwebsrv -t 10000 -v -b";
  if (isOSX(hostId))   vboxwebsrv="cd /Applications/VirtualBox.app/Contents/MacOS/ && " + vboxwebsrv;
  compute.runScriptOnNode(hostId,vboxwebsrv,runAsRoot(false).wrapInInitScript(false).blockOnComplete(false).nameTask("vboxwebsrv"));
  manager.connect(endpoint.toASCIIString(),credentials.identity,credentials.credential);
  return manager;
}
