{
  String bucketName=null;
  try {
    bucketName=getContainerName();
    addBlobToContainer(bucketName,"item1/subobject2");
    addBlobToContainer(bucketName,"item2");
    addBlobToContainer(bucketName,"object1");
    addBlobToContainer(bucketName,"object2/subobject1");
    S3Object[] objects;
    objects=service.listObjects(bucketName,null,null,1000);
    assertEquals(objects.length,4);
    objects=service.listObjects(bucketName,null,null,2);
    assertEquals(objects.length,4);
    assertEquals(objects[0].getKey(),"item1/subobject2");
    assertEquals(objects[3].getKey(),"object2/subobject1");
    objects=service.listObjects(bucketName,"item",null,1000);
    assertEquals(objects.length,2);
    objects=service.listObjects(bucketName,null,"/",1000);
    assertEquals(objects.length,2);
    assertEquals(objects[0].getKey(),"item2");
    assertEquals(objects[1].getKey(),"object1");
    objects=service.listObjects(bucketName,"item","/",1000);
    assertEquals(objects.length,1);
    assertEquals(objects[0].getKey(),"item2");
  }
  finally {
    returnContainer(bucketName);
  }
}
