{
  if (from == null)   return null;
  MutableObjectInfoWithMetadata to=new MutableObjectInfoWithMetadataImpl();
  if (from.getType() == StorageType.BLOB) {
    to.setContentType(((BlobMetadata)from).getContentType());
    to.setHash(((BlobMetadata)from).getContentMD5());
  }
 else   if (from.getType() == StorageType.RELATIVE_PATH) {
    to.setContentType("application/directory");
  }
  if (from.getETag() != null && to.getHash() == null)   to.setHash(encryptionService.fromHexString(from.getETag()));
  to.setName(from.getName());
  to.setLastModified(from.getLastModified());
  if (from.getSize() != null)   to.setBytes(from.getSize());
  if (from.getUserMetadata() != null)   to.getMetadata().putAll(from.getUserMetadata());
  return to;
}
