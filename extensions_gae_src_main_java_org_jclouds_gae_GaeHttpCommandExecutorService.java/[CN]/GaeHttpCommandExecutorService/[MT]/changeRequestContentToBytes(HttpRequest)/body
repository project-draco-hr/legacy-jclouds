{
  Payload content=request.getPayload();
  if (content == null || content instanceof ByteArrayPayload) {
    return;
  }
 else   if (content instanceof StringPayload) {
    String string=((StringPayload)content).getRawContent();
    request.setPayload(string.getBytes());
  }
 else   if (content instanceof InputStreamPayload || content instanceof FilePayload) {
    InputStream i=content.getInput();
    try {
      request.setPayload(ByteStreams.toByteArray(i));
    }
  finally {
      Closeables.closeQuietly(i);
    }
  }
 else {
    throw new UnsupportedOperationException("Content not supported " + content.getClass());
  }
}
