{
  ElasticLoadBalancerClient elbClient=EC2Client.class.cast(context.getProviderSpecificContext().getApi()).getElasticLoadBalancerServices();
  String tag="jcloudsElbTest";
  Template template=client.templateBuilder().build();
  Set<? extends NodeMetadata> nodes=client.runNodesWithTag(tag,2,template);
  Set<String> instanceIds=new HashSet<String>();
  for (  NodeMetadata node : nodes) {
    instanceIds.add(node.getId());
  }
  String dnsName=client.loadBalanceNodesMatching(tag,"HTTP",80,80,NodePredicates.withTag(tag));
  assertNotNull(dnsName);
  Set<ElasticLoadBalancer> elbs=elbClient.describeLoadBalancers(Region.US_EAST_1,tag);
  assertNotNull(elbs);
  ElasticLoadBalancer elb=elbs.iterator().next();
  assertEquals(elb.getInstanceIds(),instanceIds);
  elbClient.deleteLoadBalancer(Region.US_EAST_1,tag);
  client.destroyNodesMatching(NodePredicates.withTag(tag));
}
